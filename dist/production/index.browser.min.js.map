{"version":3,"sources":["architecture/layer/Layer.js","architecture/layer/ConvolutionLayer.js","methods/Activation.js","architecture/Connection.js","methods/Utils.js","architecture/Node.js","architecture/layer/DenseLayer.js","architecture/layer/GaussianNoiseLayer.js","architecture/layer/InputLayer.js","architecture/layer/LSTMLayer.js","architecture/layer/PoolLayer.js","architecture/layer/RNNLayer.js","architecture/Architect.js","methods/Mutation.js","methods/Loss.js","methods/Rate.js","methods/Selection.js","NEAT.js","architecture/Network.js","architecture/node.js","index.js","../../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["Object","defineProperty","exports","value","Layer","inputSize","outputSize","nodes","connections","__extends","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","Layer_1","require","ConvolutionLayer","_super","call","Activation","type","ActivationType","NO_ACTIVATION","getActivation","activationType","LogisticActivation","TanhActivation","IdentityActivation","StepActivation","RELUActivation","SoftsignActivation","SinusoidActivation","GaussianActivation","BentIdentityActivation","BipolarActivation","BipolarSigmoidActivation","HardTanhActivation","AbsoluteActivation","InverseActivation","SELUActivation","ReferenceError","ALL_ACTIVATIONS","calc","x","derivative","Math","exp","tanh","abs","cos","sin","sqrt","max","min","alpha","scale","Connection","from","to","weight","gateNode","gain","eligibility","deltaWeightsPrevious","deltaWeightsTotal","xTraceNodes","xTraceValues","addGate","innovationID","a","toJSON","fromIndex","index","toIndex","gateNodeIndex","pickRandom","arr","randInt","length","floor","random","randDouble","randBoolean","anyMatch","target","_i","arr_1","elem","remove","indexOf","splice","getOrDefault","defaultValue","shuffle","array","counter","temp","NodeType","Activation_1","Connection_1","Utils_1","Node","HIDDEN","bias","squash","activation","state","old","mask","deltaBiasPrevious","deltaBiasTotal","incoming","outgoing","gated","selfConnection","errorResponsibility","errorProjected","errorGated","NaN","fromJSON","json","node","clear","_a","connection","_b","_c","mutateBias","method","mutateActivation","newActivationType","isProjectedBy","map","conn","isProjectingTo","push","removeGate","connect","twoSided","disconnect","undefined","Error","propagate","momentum","rate","update","Number","isFinite","influence","_d","_e","gradient","j","responsibility","projected","activate","input","trace","_this","forEach","nodes_1","influences_1","i","INPUT","Node_1","DenseLayer","filter","inputNode","OUTPUT","outputNode","GaussianNoiseLayer","InputLayer","LSTMLayer","PoolingType","PoolLayer","RNNLayer","Architect","layers","addLayer","layer","RangeError","Mutation","AddNodeMutation","randomActivation","mutate","genome","maxNodes","minBound","newConnection1","newConnection2","SubNodeMutation","keepGates","possible","removeNode","AddConnectionMutation","apply","arguments","maxConnections","pair","SubConnectionMutation","randomConnection","ModWeightMutation","ModBiasMutation","ModActivationMutation","mutateOutput","AddSelfConnectionMutation","SubSelfConnectionMutation","AddGateMutation","maxGates","gates","SubGateMutation","AddBackConnectionMutation","SubBackConnectionMutation","SwapNodesMutation","node1_1","node2","biasTemp","squashTemp","ALL_MUTATIONS","FEEDFORWARD_MUTATIONS","Loss","CrossEntropyLoss","targets","outputs","error","log","MSELoss","pow","BinaryLoss","round","MAELoss","MAPELoss","WAPELoss","sum","MSLELoss","HINGELoss","Rate","baseRate","FixedRate","iteration","StepRate","gamma","stepSize","ExponentialRate","InverseRate","power","Selection","FitnessProportionateSelection","select","population","totalFitness","minimalFitness","score","population_1","PowerSelection","TournamentSelection","size","probability","individuals","sort","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","adopt","done","then","__generator","body","_","f","y","t","g","label","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","pop","__spreadArrays","s","il","r","k","jl","Network_1","Loss_1","Selection_1","Mutation_1","NEAT","dataset","options","generation","output","equal","populationSize","growth","loss","amount","elitism","provenance","mutationRate","mutationAmount","fitnessPopulation","fitnessFunction","selection","mutations","template","Network","Infinity","createInitialPopulation","filterGenome","pickGenome","adjustGenome","filtered","copy","mutateRandom","name","evolve","elitists","newPopulation","fittest","evaluate","fill","getOffspring","parent1","parent2","crossOver","getFittest","getAverage","val","Rate_1","NEAT_1","network","nodeJSON","jsonConnection","network1","network2","offspring","score1","offspringSize","score2","chosenNode","inputNumber","sourceNetwork","outputNumber","newNode","n1connections","n2connections","keys1","keys","keys2","parseInt","key","connectionJSON","dropoutRate","inputNodeIndex","targetIndex","inputs","gate","shift","allowedMethods","train","iterations","dropout","batchSize","ratePolicy","targetError","trainingSetSize","trainingSet","testSet","currentTrainingRate","start","Date","now","crossValidateTestSize","ceil","slice","iterationCount","trainError","trainEpoch","test","console","schedule","function","time","trainingRate","errorSum","correctOutput","dataset_1","entry","neat","bestFitness","bestGenome","fitness","isArray","all","ConvolutionLayer_1","DenseLayer_1","GaussianNoiseLayer_1","InputLayer_1","LSTMLayer_1","PoolLayer_1","RNNLayer_1","Architect_1","node_1","checkedAssets","assetsToAccept","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","handled","assets","asset","isNew","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","hmrApply","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","message","stack","overlay","createErrorOverlay","document","appendChild","getElementById","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","dep","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"index.browser.min.js","sourceRoot":"..\\..\\build\\src","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer = /** @class */ (function () {\r\n    function Layer(inputSize, outputSize) {\r\n        this.inputSize = inputSize;\r\n        this.outputSize = outputSize;\r\n        this.nodes = [];\r\n        this.connections = [];\r\n    }\r\n    return Layer;\r\n}());\r\nexports.Layer = Layer;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar ConvolutionLayer = /** @class */ (function (_super) {\r\n    __extends(ConvolutionLayer, _super);\r\n    function ConvolutionLayer(inputSize, outputSize) {\r\n        return _super.call(this, inputSize, outputSize) || this;\r\n    }\r\n    return ConvolutionLayer;\r\n}(Layer_1.Layer));\r\nexports.ConvolutionLayer = ConvolutionLayer;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Activation = /** @class */ (function () {\r\n    function Activation() {\r\n        this.type = ActivationType.NO_ACTIVATION;\r\n    }\r\n    Activation.getActivation = function (activationType) {\r\n        switch (activationType) {\r\n            case ActivationType.LogisticActivation:\r\n                return new LogisticActivation();\r\n            case ActivationType.TanhActivation:\r\n                return new TanhActivation();\r\n            case ActivationType.IdentityActivation:\r\n                return new IdentityActivation();\r\n            case ActivationType.StepActivation:\r\n                return new StepActivation();\r\n            case ActivationType.RELUActivation:\r\n                return new RELUActivation();\r\n            case ActivationType.SoftsignActivation:\r\n                return new SoftsignActivation();\r\n            case ActivationType.SinusoidActivation:\r\n                return new LogisticActivation();\r\n            case ActivationType.GaussianActivation:\r\n                return new GaussianActivation();\r\n            case ActivationType.BentIdentityActivation:\r\n                return new BentIdentityActivation();\r\n            case ActivationType.BipolarActivation:\r\n                return new BipolarActivation();\r\n            case ActivationType.BipolarSigmoidActivation:\r\n                return new BipolarSigmoidActivation();\r\n            case ActivationType.HardTanhActivation:\r\n                return new HardTanhActivation();\r\n            case ActivationType.AbsoluteActivation:\r\n                return new AbsoluteActivation();\r\n            case ActivationType.InverseActivation:\r\n                return new InverseActivation();\r\n            case ActivationType.SELUActivation:\r\n                return new SELUActivation();\r\n        }\r\n        throw new ReferenceError(activationType + \" is not the name of any available activations! These are all available activations: \" + exports.ALL_ACTIVATIONS);\r\n    };\r\n    return Activation;\r\n}());\r\nexports.Activation = Activation;\r\nvar LogisticActivation = /** @class */ (function () {\r\n    function LogisticActivation() {\r\n        this.type = ActivationType.LogisticActivation;\r\n    }\r\n    LogisticActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return 1 / (1 + Math.exp(-x));\r\n        }\r\n        else {\r\n            return this.calc(x, false) * (1 - this.calc(x, false));\r\n        }\r\n    };\r\n    return LogisticActivation;\r\n}());\r\nexports.LogisticActivation = LogisticActivation;\r\nvar TanhActivation = /** @class */ (function () {\r\n    function TanhActivation() {\r\n        this.type = ActivationType.TanhActivation;\r\n    }\r\n    TanhActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return Math.tanh(x);\r\n        }\r\n        else {\r\n            return 1 - this.calc(x, false) * this.calc(x, false);\r\n        }\r\n    };\r\n    return TanhActivation;\r\n}());\r\nexports.TanhActivation = TanhActivation;\r\nvar IdentityActivation = /** @class */ (function () {\r\n    function IdentityActivation() {\r\n        this.type = ActivationType.IdentityActivation;\r\n    }\r\n    IdentityActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return x;\r\n        }\r\n        else {\r\n            return 1;\r\n        }\r\n    };\r\n    return IdentityActivation;\r\n}());\r\nexports.IdentityActivation = IdentityActivation;\r\nvar StepActivation = /** @class */ (function () {\r\n    function StepActivation() {\r\n        this.type = ActivationType.StepActivation;\r\n    }\r\n    StepActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return x < 0 ? 0 : 1;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    };\r\n    return StepActivation;\r\n}());\r\nexports.StepActivation = StepActivation;\r\nvar RELUActivation = /** @class */ (function () {\r\n    function RELUActivation() {\r\n        this.type = ActivationType.RELUActivation;\r\n    }\r\n    RELUActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return x <= 0 ? 0 : x;\r\n        }\r\n        else {\r\n            return x <= 0 ? 0 : 1;\r\n        }\r\n    };\r\n    return RELUActivation;\r\n}());\r\nexports.RELUActivation = RELUActivation;\r\nvar SoftsignActivation = /** @class */ (function () {\r\n    function SoftsignActivation() {\r\n        this.type = ActivationType.SoftsignActivation;\r\n    }\r\n    SoftsignActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return x / (1 + Math.abs(x));\r\n        }\r\n        else {\r\n            return x / ((1 + Math.abs(x)) * (1 + Math.abs(x)));\r\n        }\r\n    };\r\n    return SoftsignActivation;\r\n}());\r\nexports.SoftsignActivation = SoftsignActivation;\r\nvar SinusoidActivation = /** @class */ (function () {\r\n    function SinusoidActivation() {\r\n        this.type = ActivationType.SinusoidActivation;\r\n    }\r\n    SinusoidActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return Math.sin(x);\r\n        }\r\n        else {\r\n            return Math.cos(x);\r\n        }\r\n    };\r\n    return SinusoidActivation;\r\n}());\r\nexports.SinusoidActivation = SinusoidActivation;\r\nvar GaussianActivation = /** @class */ (function () {\r\n    function GaussianActivation() {\r\n        this.type = ActivationType.GaussianActivation;\r\n    }\r\n    GaussianActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return Math.exp(-x * x);\r\n        }\r\n        else {\r\n            return -2 * x * this.calc(x, false);\r\n        }\r\n    };\r\n    return GaussianActivation;\r\n}());\r\nexports.GaussianActivation = GaussianActivation;\r\nvar BentIdentityActivation = /** @class */ (function () {\r\n    function BentIdentityActivation() {\r\n        this.type = ActivationType.BentIdentityActivation;\r\n    }\r\n    BentIdentityActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return (Math.sqrt(x * x + 1) - 1) / 2 + x;\r\n        }\r\n        else {\r\n            return x / (2 * Math.sqrt(x * x + 1)) + 1;\r\n        }\r\n    };\r\n    return BentIdentityActivation;\r\n}());\r\nexports.BentIdentityActivation = BentIdentityActivation;\r\nvar BipolarActivation = /** @class */ (function () {\r\n    function BipolarActivation() {\r\n        this.type = ActivationType.BipolarActivation;\r\n    }\r\n    BipolarActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return x > 0 ? 1 : -1;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    };\r\n    return BipolarActivation;\r\n}());\r\nexports.BipolarActivation = BipolarActivation;\r\nvar BipolarSigmoidActivation = /** @class */ (function () {\r\n    function BipolarSigmoidActivation() {\r\n        this.type = ActivationType.BipolarSigmoidActivation;\r\n    }\r\n    BipolarSigmoidActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return 2 / (1 + Math.exp(-x)) - 1;\r\n        }\r\n        else {\r\n            return (2 * Math.exp(-x)) / ((1 + Math.exp(-x)) * (1 + Math.exp(-x)));\r\n        }\r\n    };\r\n    return BipolarSigmoidActivation;\r\n}());\r\nexports.BipolarSigmoidActivation = BipolarSigmoidActivation;\r\nvar HardTanhActivation = /** @class */ (function () {\r\n    function HardTanhActivation() {\r\n        this.type = ActivationType.HardTanhActivation;\r\n    }\r\n    HardTanhActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return Math.max(-1, Math.min(1, x));\r\n        }\r\n        else {\r\n            return Math.abs(x) < 1 ? 1 : 0;\r\n        }\r\n    };\r\n    return HardTanhActivation;\r\n}());\r\nexports.HardTanhActivation = HardTanhActivation;\r\nvar AbsoluteActivation = /** @class */ (function () {\r\n    function AbsoluteActivation() {\r\n        this.type = ActivationType.AbsoluteActivation;\r\n    }\r\n    AbsoluteActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return Math.abs(x);\r\n        }\r\n        else {\r\n            return x < 0 ? -1 : 1;\r\n        }\r\n    };\r\n    return AbsoluteActivation;\r\n}());\r\nexports.AbsoluteActivation = AbsoluteActivation;\r\nvar InverseActivation = /** @class */ (function () {\r\n    function InverseActivation() {\r\n        this.type = ActivationType.InverseActivation;\r\n    }\r\n    InverseActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        if (!derivative) {\r\n            return 1 - x;\r\n        }\r\n        else {\r\n            return -1;\r\n        }\r\n    };\r\n    return InverseActivation;\r\n}());\r\nexports.InverseActivation = InverseActivation;\r\nvar SELUActivation = /** @class */ (function () {\r\n    function SELUActivation() {\r\n        this.type = ActivationType.SELUActivation;\r\n    }\r\n    SELUActivation.prototype.calc = function (x, derivative) {\r\n        if (derivative === void 0) { derivative = false; }\r\n        var alpha = 1.6732632423543772848170429916717;\r\n        var scale = 1.0507009873554804934193349852946;\r\n        if (!derivative) {\r\n            if (x > 0) {\r\n                return x * scale;\r\n            }\r\n            else {\r\n                return alpha * Math.exp(x) - alpha * scale;\r\n            }\r\n        }\r\n        else if (x > 0) {\r\n            return scale;\r\n        }\r\n        else {\r\n            return alpha * Math.exp(x) * scale;\r\n        }\r\n    };\r\n    return SELUActivation;\r\n}());\r\nexports.SELUActivation = SELUActivation;\r\nvar ActivationType;\r\n(function (ActivationType) {\r\n    ActivationType[ActivationType[\"NO_ACTIVATION\"] = 0] = \"NO_ACTIVATION\";\r\n    ActivationType[ActivationType[\"LogisticActivation\"] = 1] = \"LogisticActivation\";\r\n    ActivationType[ActivationType[\"TanhActivation\"] = 2] = \"TanhActivation\";\r\n    ActivationType[ActivationType[\"IdentityActivation\"] = 3] = \"IdentityActivation\";\r\n    ActivationType[ActivationType[\"StepActivation\"] = 4] = \"StepActivation\";\r\n    ActivationType[ActivationType[\"RELUActivation\"] = 5] = \"RELUActivation\";\r\n    ActivationType[ActivationType[\"SoftsignActivation\"] = 6] = \"SoftsignActivation\";\r\n    ActivationType[ActivationType[\"SinusoidActivation\"] = 7] = \"SinusoidActivation\";\r\n    ActivationType[ActivationType[\"GaussianActivation\"] = 8] = \"GaussianActivation\";\r\n    ActivationType[ActivationType[\"BentIdentityActivation\"] = 9] = \"BentIdentityActivation\";\r\n    ActivationType[ActivationType[\"BipolarActivation\"] = 10] = \"BipolarActivation\";\r\n    ActivationType[ActivationType[\"BipolarSigmoidActivation\"] = 11] = \"BipolarSigmoidActivation\";\r\n    ActivationType[ActivationType[\"HardTanhActivation\"] = 12] = \"HardTanhActivation\";\r\n    ActivationType[ActivationType[\"AbsoluteActivation\"] = 13] = \"AbsoluteActivation\";\r\n    ActivationType[ActivationType[\"InverseActivation\"] = 14] = \"InverseActivation\";\r\n    ActivationType[ActivationType[\"SELUActivation\"] = 15] = \"SELUActivation\";\r\n})(ActivationType = exports.ActivationType || (exports.ActivationType = {}));\r\nexports.ALL_ACTIVATIONS = [\r\n    ActivationType.LogisticActivation,\r\n    ActivationType.TanhActivation,\r\n    ActivationType.IdentityActivation,\r\n    ActivationType.StepActivation,\r\n    ActivationType.RELUActivation,\r\n    ActivationType.SoftsignActivation,\r\n    ActivationType.SinusoidActivation,\r\n    ActivationType.GaussianActivation,\r\n    ActivationType.BentIdentityActivation,\r\n    ActivationType.BipolarActivation,\r\n    ActivationType.BipolarSigmoidActivation,\r\n    ActivationType.HardTanhActivation,\r\n    ActivationType.AbsoluteActivation,\r\n    ActivationType.InverseActivation,\r\n    ActivationType.SELUActivation\r\n];\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Connection = /** @class */ (function () {\r\n    function Connection(from, to, weight, gateNode) {\r\n        this.from = from;\r\n        this.to = to;\r\n        this.weight = weight || 0;\r\n        this.gain = 1;\r\n        this.eligibility = 0;\r\n        this.deltaWeightsPrevious = 0;\r\n        this.deltaWeightsTotal = 0;\r\n        this.xTraceNodes = [];\r\n        this.xTraceValues = [];\r\n        if (gateNode) {\r\n            this.gateNode = gateNode;\r\n            gateNode.addGate(this);\r\n        }\r\n        else {\r\n            this.gateNode = null;\r\n        }\r\n    }\r\n    Connection.innovationID = function (a, b) {\r\n        return 1 / 2 * (a + b) * (a + b + 1) + b;\r\n    };\r\n    Connection.prototype.toJSON = function () {\r\n        return {\r\n            fromIndex: this.from.index,\r\n            toIndex: this.to.index,\r\n            gateNodeIndex: this.gateNode === null ? null : this.gateNode.index,\r\n            weight: this.weight\r\n        };\r\n    };\r\n    return Connection;\r\n}());\r\nexports.Connection = Connection;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction pickRandom(arr) {\r\n    return arr[randInt(0, arr.length)];\r\n}\r\nexports.pickRandom = pickRandom;\r\nfunction randInt(min, max) {\r\n    return Math.floor(Math.random() * (max - min) + min);\r\n}\r\nexports.randInt = randInt;\r\nfunction randDouble(min, max) {\r\n    return Math.random() * (max - min) + min;\r\n}\r\nexports.randDouble = randDouble;\r\nfunction randBoolean() {\r\n    return Math.random() >= 0.5;\r\n}\r\nexports.randBoolean = randBoolean;\r\nfunction anyMatch(arr, target) {\r\n    for (var _i = 0, arr_1 = arr; _i < arr_1.length; _i++) {\r\n        var elem = arr_1[_i];\r\n        if (elem === target) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexports.anyMatch = anyMatch;\r\nfunction remove(arr, elem) {\r\n    var index = arr.indexOf(elem);\r\n    if (index === -1) {\r\n        return false;\r\n    }\r\n    else {\r\n        arr.splice(index, 1);\r\n        return true;\r\n    }\r\n}\r\nexports.remove = remove;\r\nfunction getOrDefault(value, defaultValue) {\r\n    return value !== undefined && value !== null ? value : defaultValue;\r\n}\r\nexports.getOrDefault = getOrDefault;\r\nfunction shuffle(array) {\r\n    var counter = array.length;\r\n    // While there are elements in the array\r\n    while (counter > 0) {\r\n        // Pick a random index\r\n        var index = randInt(0, counter);\r\n        // Decrease counter by 1\r\n        counter--;\r\n        // And swap the last element with it\r\n        var temp = array[counter];\r\n        array[counter] = array[index];\r\n        array[index] = temp;\r\n    }\r\n    return array;\r\n}\r\nexports.shuffle = shuffle;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Activation_1 = require(\"../methods/Activation\");\r\nvar Connection_1 = require(\"./Connection\");\r\nvar Utils_1 = require(\"../methods/Utils\");\r\nvar NodeType;\r\n(function (NodeType) {\r\n    NodeType[NodeType[\"INPUT\"] = 0] = \"INPUT\";\r\n    NodeType[NodeType[\"HIDDEN\"] = 1] = \"HIDDEN\";\r\n    NodeType[NodeType[\"OUTPUT\"] = 2] = \"OUTPUT\";\r\n})(NodeType = exports.NodeType || (exports.NodeType = {}));\r\nvar Node = /** @class */ (function () {\r\n    function Node(type) {\r\n        if (type === void 0) { type = NodeType.HIDDEN; }\r\n        this.type = type;\r\n        this.bias = Utils_1.randDouble(-1, 1);\r\n        this.squash = new Activation_1.LogisticActivation();\r\n        this.activation = 0;\r\n        this.state = 0;\r\n        this.old = 0;\r\n        this.mask = 1;\r\n        this.deltaBiasPrevious = 0;\r\n        this.deltaBiasTotal = 0;\r\n        this.incoming = [];\r\n        this.outgoing = [];\r\n        this.gated = [];\r\n        this.selfConnection = new Connection_1.Connection(this, this, 0);\r\n        this.errorResponsibility = 0;\r\n        this.errorProjected = 0;\r\n        this.errorGated = 0;\r\n        this.index = NaN;\r\n    }\r\n    Node.fromJSON = function (json) {\r\n        var node = new Node();\r\n        node.bias = json.bias;\r\n        node.type = json.type;\r\n        node.squash = Activation_1.Activation.getActivation(json.squash);\r\n        node.mask = json.mask;\r\n        node.index = json.index;\r\n        return node;\r\n    };\r\n    Node.prototype.clear = function () {\r\n        for (var _i = 0, _a = this.incoming; _i < _a.length; _i++) {\r\n            var connection = _a[_i];\r\n            connection.eligibility = 0;\r\n            connection.xTraceNodes = [];\r\n            connection.xTraceValues = [];\r\n        }\r\n        for (var _b = 0, _c = this.gated; _b < _c.length; _b++) {\r\n            var connection = _c[_b];\r\n            connection.gain = 0;\r\n        }\r\n        this.errorResponsibility = this.errorProjected = this.errorGated = 0;\r\n        this.old = this.state = this.activation = 0;\r\n    };\r\n    Node.prototype.mutateBias = function (method) {\r\n        this.bias += Utils_1.randDouble(method.min, method.max);\r\n    };\r\n    Node.prototype.mutateActivation = function () {\r\n        var newActivationType;\r\n        do {\r\n            newActivationType = Utils_1.pickRandom(Activation_1.ALL_ACTIVATIONS);\r\n        } while (newActivationType === this.squash.type);\r\n        this.squash = Activation_1.Activation.getActivation(newActivationType);\r\n    };\r\n    Node.prototype.isProjectedBy = function (node) {\r\n        if (node === this) {\r\n            return this.selfConnection.weight !== 0;\r\n        }\r\n        else {\r\n            return Utils_1.anyMatch(this.incoming.map(function (conn) { return conn.from; }), node);\r\n        }\r\n    };\r\n    Node.prototype.isProjectingTo = function (node) {\r\n        if (node === this) {\r\n            return this.selfConnection.weight !== 0;\r\n        }\r\n        else {\r\n            return Utils_1.anyMatch(this.outgoing.map(function (conn) { return conn.to; }), node);\r\n        }\r\n    };\r\n    Node.prototype.addGate = function (connection) {\r\n        this.gated.push(connection);\r\n        connection.gateNode = this;\r\n    };\r\n    Node.prototype.removeGate = function (connection) {\r\n        Utils_1.remove(this.gated, connection);\r\n        connection.gateNode = null;\r\n        connection.gain = 1;\r\n    };\r\n    Node.prototype.connect = function (target, weight, twoSided) {\r\n        if (weight === void 0) { weight = 0; }\r\n        if (twoSided === void 0) { twoSided = false; }\r\n        if (target === this) {\r\n            this.selfConnection.weight = weight || 1;\r\n            return this.selfConnection;\r\n        }\r\n        else if (this.isProjectingTo(target)) {\r\n            throw new ReferenceError();\r\n        }\r\n        else {\r\n            var connection = new Connection_1.Connection(this, target, weight);\r\n            this.outgoing.push(connection);\r\n            target.incoming.push(connection);\r\n            if (twoSided) {\r\n                target.connect(this);\r\n            }\r\n            return connection;\r\n        }\r\n    };\r\n    Node.prototype.disconnect = function (node, twoSided) {\r\n        if (twoSided === void 0) { twoSided = false; }\r\n        if (node === this) {\r\n            this.selfConnection.weight = 0;\r\n            return this.selfConnection;\r\n        }\r\n        for (var _i = 0, _a = this.outgoing; _i < _a.length; _i++) {\r\n            var connection = _a[_i];\r\n            if (connection.to !== node) {\r\n                continue;\r\n            }\r\n            Utils_1.remove(this.outgoing, connection);\r\n            Utils_1.remove(connection.to.incoming, connection);\r\n            if (connection.gateNode !== undefined && connection.gateNode != null) {\r\n                connection.gateNode.removeGate(connection);\r\n            }\r\n            if (twoSided) {\r\n                node.disconnect(this);\r\n            }\r\n            return connection;\r\n        }\r\n        throw new Error(\"No connection found!\");\r\n    };\r\n    Node.prototype.propagate = function (target, momentum, rate, update) {\r\n        // TODO: check for errors\r\n        if (target !== undefined && Number.isFinite(target)) {\r\n            this.errorResponsibility = this.errorProjected = target - this.activation;\r\n        }\r\n        else {\r\n            this.errorProjected = 0;\r\n            for (var _i = 0, _a = this.outgoing; _i < _a.length; _i++) {\r\n                var connection = _a[_i];\r\n                this.errorProjected += connection.to.errorResponsibility * connection.weight * connection.gain;\r\n            }\r\n            this.errorProjected *= this.derivative || 1;\r\n            this.errorGated = 0;\r\n            for (var _b = 0, _c = this.gated; _b < _c.length; _b++) {\r\n                var connection = _c[_b];\r\n                var node = connection.to;\r\n                var influence = void 0;\r\n                if (node.selfConnection.gateNode === this) {\r\n                    influence = node.old + connection.weight * connection.from.activation;\r\n                }\r\n                else {\r\n                    influence = connection.weight * connection.from.activation;\r\n                }\r\n                this.errorGated += node.errorResponsibility * influence;\r\n            }\r\n            this.errorGated *= this.derivative || 1;\r\n            this.errorResponsibility = this.errorProjected + this.errorGated;\r\n        }\r\n        for (var _d = 0, _e = this.incoming; _d < _e.length; _d++) {\r\n            var connection = _e[_d];\r\n            var gradient = this.errorProjected * connection.eligibility;\r\n            for (var j = 0; j < connection.xTraceNodes.length; j++) {\r\n                var node = connection.xTraceNodes[j];\r\n                gradient += node.errorResponsibility * connection.xTraceValues[j];\r\n            }\r\n            connection.deltaWeightsTotal += rate * gradient * this.mask;\r\n            if (update) {\r\n                connection.deltaWeightsTotal += momentum * connection.deltaWeightsPrevious;\r\n                connection.weight += connection.deltaWeightsTotal;\r\n                connection.deltaWeightsPrevious = connection.deltaWeightsTotal;\r\n                connection.deltaWeightsTotal = 0;\r\n            }\r\n        }\r\n        this.deltaBiasTotal += rate * this.errorResponsibility;\r\n        if (update) {\r\n            this.deltaBiasTotal += momentum * this.deltaBiasPrevious;\r\n            this.bias += this.deltaBiasTotal;\r\n            this.deltaBiasPrevious = this.deltaBiasTotal;\r\n            this.deltaBiasTotal = 0;\r\n        }\r\n        return {\r\n            responsibility: this.errorResponsibility,\r\n            projected: this.errorProjected,\r\n            gated: this.errorGated,\r\n        };\r\n    };\r\n    Node.prototype.activate = function (input, trace) {\r\n        var _this = this;\r\n        if (input === void 0) { input = null; }\r\n        if (trace === void 0) { trace = true; }\r\n        // TODO: check for errors\r\n        if (input !== null && Number.isFinite(input)) {\r\n            return this.activation = input;\r\n        }\r\n        if (trace) {\r\n            this.old = this.state;\r\n            this.state = this.selfConnection.gain * this.selfConnection.weight * this.state + this.bias;\r\n            this.incoming.forEach(function (conn) {\r\n                _this.state += conn.from.activation * conn.weight * conn.gain;\r\n            });\r\n            this.activation = this.squash.calc(this.state, false) * this.mask;\r\n            this.derivative = this.squash.calc(this.state, true);\r\n            var nodes_1 = [];\r\n            var influences_1 = [];\r\n            this.gated.forEach(function (connection) {\r\n                connection.gain = _this.activation;\r\n                var index = nodes_1.indexOf(connection.to);\r\n                if (index > -1) {\r\n                    influences_1[index] += connection.weight * connection.from.activation;\r\n                }\r\n                else {\r\n                    nodes_1.push(connection.to);\r\n                    if (connection.to.selfConnection.gateNode === _this) {\r\n                        influences_1.push(connection.weight * connection.from.activation + connection.to.old);\r\n                    }\r\n                    else {\r\n                        influences_1.push(connection.weight * connection.from.activation);\r\n                    }\r\n                }\r\n            });\r\n            for (var _i = 0, _a = this.incoming; _i < _a.length; _i++) {\r\n                var connection = _a[_i];\r\n                connection.eligibility = this.selfConnection.gain * this.selfConnection.weight * connection.eligibility + connection.from.activation * connection.gain;\r\n                for (var i = 0; i < nodes_1.length; i++) {\r\n                    var node = nodes_1[i];\r\n                    var influence = influences_1[i];\r\n                    var index = connection.xTraceNodes.indexOf(node);\r\n                    if (index > -1)\r\n                        connection.xTraceValues[index] = node.selfConnection.gain * node.selfConnection.weight * connection.xTraceValues[index] + this.derivative * connection.eligibility * influence;\r\n                    else {\r\n                        connection.xTraceNodes.push(node);\r\n                        connection.xTraceValues.push(this.derivative * connection.eligibility * influence);\r\n                    }\r\n                }\r\n            }\r\n            return this.activation;\r\n        }\r\n        else {\r\n            if (this.type === NodeType.INPUT)\r\n                return this.activation = 0;\r\n            this.state = this.selfConnection.gain * this.selfConnection.weight * this.state + this.bias;\r\n            for (var _b = 0, _c = this.incoming; _b < _c.length; _b++) {\r\n                var connection = _c[_b];\r\n                this.state += connection.from.activation * connection.weight * connection.gain;\r\n            }\r\n            this.activation = this.squash.calc(this.state, false);\r\n            for (var _d = 0, _e = this.gated; _d < _e.length; _d++) {\r\n                var connection = _e[_d];\r\n                connection.gain = this.activation;\r\n            }\r\n            return this.activation;\r\n        }\r\n    };\r\n    Node.prototype.toJSON = function () {\r\n        return {\r\n            bias: this.bias,\r\n            type: this.type,\r\n            squash: this.squash.type,\r\n            mask: this.mask,\r\n            index: this.index\r\n        };\r\n    };\r\n    return Node;\r\n}());\r\nexports.Node = Node;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar Node_1 = require(\"../Node\");\r\nvar DenseLayer = /** @class */ (function (_super) {\r\n    __extends(DenseLayer, _super);\r\n    function DenseLayer(inputSize, outputSize) {\r\n        var _this = _super.call(this, inputSize, outputSize) || this;\r\n        for (var i = 0; i < inputSize; i++) {\r\n            _this.nodes.push(new Node_1.Node(Node_1.NodeType.INPUT));\r\n        }\r\n        for (var i = 0; i < outputSize; i++) {\r\n            _this.nodes.push(new Node_1.Node(Node_1.NodeType.INPUT));\r\n        }\r\n        _this.nodes\r\n            .filter(function (node) { return node.type === Node_1.NodeType.INPUT; })\r\n            .forEach(function (inputNode) {\r\n            _this.nodes\r\n                .filter(function (node) { return node.type === Node_1.NodeType.OUTPUT; })\r\n                .forEach(function (outputNode) {\r\n                _this.connections.push(inputNode.connect(outputNode, 1));\r\n            });\r\n        });\r\n        return _this;\r\n    }\r\n    return DenseLayer;\r\n}(Layer_1.Layer));\r\nexports.DenseLayer = DenseLayer;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar GaussianNoiseLayer = /** @class */ (function (_super) {\r\n    __extends(GaussianNoiseLayer, _super);\r\n    function GaussianNoiseLayer(inputSize, outputSize) {\r\n        return _super.call(this, inputSize, outputSize) || this;\r\n    }\r\n    return GaussianNoiseLayer;\r\n}(Layer_1.Layer));\r\nexports.GaussianNoiseLayer = GaussianNoiseLayer;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar InputLayer = /** @class */ (function (_super) {\r\n    __extends(InputLayer, _super);\r\n    function InputLayer(inputSize, outputSize) {\r\n        return _super.call(this, inputSize, outputSize) || this;\r\n    }\r\n    return InputLayer;\r\n}(Layer_1.Layer));\r\nexports.InputLayer = InputLayer;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar LSTMLayer = /** @class */ (function (_super) {\r\n    __extends(LSTMLayer, _super);\r\n    function LSTMLayer(inputSize, outputSize) {\r\n        return _super.call(this, inputSize, outputSize) || this;\r\n        // TODO: actually implement\r\n    }\r\n    return LSTMLayer;\r\n}(Layer_1.Layer));\r\nexports.LSTMLayer = LSTMLayer;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar PoolLayer = /** @class */ (function (_super) {\r\n    __extends(PoolLayer, _super);\r\n    function PoolLayer(inputSize, outputSize, type) {\r\n        return _super.call(this, inputSize, outputSize) || this;\r\n        // TODO: actually implement it\r\n    }\r\n    return PoolLayer;\r\n}(Layer_1.Layer));\r\nexports.PoolLayer = PoolLayer;\r\nvar PoolingType;\r\n(function (PoolingType) {\r\n    PoolingType[PoolingType[\"MaxPooling\"] = 0] = \"MaxPooling\";\r\n    PoolingType[PoolingType[\"AveragePooling\"] = 1] = \"AveragePooling\";\r\n    PoolingType[PoolingType[\"GlobalPooling\"] = 2] = \"GlobalPooling\";\r\n})(PoolingType = exports.PoolingType || (exports.PoolingType = {}));\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./Layer\");\r\nvar RNNLayer = /** @class */ (function (_super) {\r\n    __extends(RNNLayer, _super);\r\n    function RNNLayer(inputSize, outputSize) {\r\n        return _super.call(this, inputSize, outputSize) || this;\r\n    }\r\n    return RNNLayer;\r\n}(Layer_1.Layer));\r\nexports.RNNLayer = RNNLayer;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Architect = /** @class */ (function () {\r\n    function Architect() {\r\n        this.layers = [];\r\n    }\r\n    Architect.prototype.addLayer = function (layer) {\r\n        if (this.layers[this.layers.length - 1].outputSize !== layer.inputSize) {\r\n            throw new RangeError(\"Output size of last layer is unequal input size of this layer! \" + this.layers[this.layers.length - 1].outputSize + \" -> \" + layer.inputSize);\r\n        }\r\n        this.layers.push(layer);\r\n        return this;\r\n    };\r\n    return Architect;\r\n}());\r\nexports.Architect = Architect;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Node_1 = require(\"../architecture/Node\");\r\nvar Utils_1 = require(\"./Utils\");\r\nvar Mutation = /** @class */ (function () {\r\n    function Mutation() {\r\n    }\r\n    return Mutation;\r\n}());\r\nexports.Mutation = Mutation;\r\nvar AddNodeMutation = /** @class */ (function (_super) {\r\n    __extends(AddNodeMutation, _super);\r\n    function AddNodeMutation(randomActivation) {\r\n        if (randomActivation === void 0) { randomActivation = true; }\r\n        var _this = _super.call(this) || this;\r\n        _this.randomActivation = randomActivation;\r\n        return _this;\r\n    }\r\n    AddNodeMutation.prototype.mutate = function (genome, maxNodes) {\r\n        if (maxNodes !== undefined && genome.nodes.length >= maxNodes) {\r\n            return;\r\n        }\r\n        var node = new Node_1.Node(Node_1.NodeType.HIDDEN);\r\n        if (this.randomActivation) {\r\n            node.mutateActivation();\r\n        }\r\n        var connection = Utils_1.pickRandom(genome.connections);\r\n        var from = connection.from;\r\n        var to = connection.to;\r\n        genome.disconnect(from, to);\r\n        var minBound = Math.max(genome.inputSize, 1 + genome.nodes.indexOf(from));\r\n        genome.nodes.splice(minBound, 0, node);\r\n        var newConnection1 = genome.connect(from, node, 1);\r\n        var newConnection2 = genome.connect(node, to, connection.weight);\r\n        if (connection.gateNode != null) {\r\n            if (Utils_1.randBoolean()) {\r\n                genome.addGate(connection.gateNode, newConnection1);\r\n            }\r\n            else {\r\n                genome.addGate(connection.gateNode, newConnection2);\r\n            }\r\n        }\r\n    };\r\n    return AddNodeMutation;\r\n}(Mutation));\r\nexports.AddNodeMutation = AddNodeMutation;\r\nvar SubNodeMutation = /** @class */ (function (_super) {\r\n    __extends(SubNodeMutation, _super);\r\n    function SubNodeMutation(keepGates) {\r\n        if (keepGates === void 0) { keepGates = true; }\r\n        var _this = _super.call(this) || this;\r\n        _this.keepGates = keepGates;\r\n        return _this;\r\n    }\r\n    SubNodeMutation.prototype.mutate = function (genome) {\r\n        var possible = genome.nodes.filter(function (node) { return node !== undefined && node.type === Node_1.NodeType.HIDDEN; });\r\n        if (possible.length > 0) {\r\n            var node = Utils_1.pickRandom(possible);\r\n            genome.removeNode(node);\r\n        }\r\n    };\r\n    return SubNodeMutation;\r\n}(Mutation));\r\nexports.SubNodeMutation = SubNodeMutation;\r\nvar AddConnectionMutation = /** @class */ (function (_super) {\r\n    __extends(AddConnectionMutation, _super);\r\n    function AddConnectionMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AddConnectionMutation.prototype.mutate = function (genome, maxConnections) {\r\n        if (maxConnections !== undefined && maxConnections <= genome.connections.length) {\r\n            return;\r\n        }\r\n        var possible = [];\r\n        for (var i = 0; i < genome.nodes.length - genome.outputSize; i++) {\r\n            var from = genome.nodes[i];\r\n            for (var j = Math.max(i + 1, genome.inputSize); j < genome.nodes.length; j++) {\r\n                var to = genome.nodes[j];\r\n                if (!from.isProjectingTo(to)) {\r\n                    possible.push([from, to]);\r\n                }\r\n            }\r\n        }\r\n        if (possible.length > 0) {\r\n            var pair = Utils_1.pickRandom(possible);\r\n            genome.connect(pair[0], pair[1]);\r\n        }\r\n    };\r\n    return AddConnectionMutation;\r\n}(Mutation));\r\nexports.AddConnectionMutation = AddConnectionMutation;\r\nvar SubConnectionMutation = /** @class */ (function (_super) {\r\n    __extends(SubConnectionMutation, _super);\r\n    function SubConnectionMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SubConnectionMutation.prototype.mutate = function (genome) {\r\n        var possible = genome.connections.filter(function (conn) { return conn.from.outgoing.length > 1 && conn.to.incoming.length > 1 && genome.nodes.indexOf(conn.to) > genome.nodes.indexOf(conn.from); });\r\n        if (possible.length > 0) {\r\n            var randomConnection = Utils_1.pickRandom(possible);\r\n            genome.disconnect(randomConnection.from, randomConnection.to);\r\n        }\r\n    };\r\n    return SubConnectionMutation;\r\n}(Mutation));\r\nexports.SubConnectionMutation = SubConnectionMutation;\r\nvar ModWeightMutation = /** @class */ (function (_super) {\r\n    __extends(ModWeightMutation, _super);\r\n    function ModWeightMutation(min, max) {\r\n        if (min === void 0) { min = -1; }\r\n        if (max === void 0) { max = 1; }\r\n        var _this = _super.call(this) || this;\r\n        _this.min = min;\r\n        _this.max = max;\r\n        return _this;\r\n    }\r\n    ModWeightMutation.prototype.mutate = function (genome) {\r\n        Utils_1.pickRandom(genome.connections).weight += Utils_1.randDouble(this.min, this.max);\r\n    };\r\n    return ModWeightMutation;\r\n}(Mutation));\r\nexports.ModWeightMutation = ModWeightMutation;\r\nvar ModBiasMutation = /** @class */ (function (_super) {\r\n    __extends(ModBiasMutation, _super);\r\n    function ModBiasMutation(min, max) {\r\n        if (min === void 0) { min = -1; }\r\n        if (max === void 0) { max = 1; }\r\n        var _this = _super.call(this) || this;\r\n        _this.min = min;\r\n        _this.max = max;\r\n        return _this;\r\n    }\r\n    ModBiasMutation.prototype.mutate = function (genome) {\r\n        Utils_1.pickRandom(genome.nodes.filter(function (node) { return node.type !== Node_1.NodeType.INPUT; }))\r\n            .mutateBias(this);\r\n    };\r\n    return ModBiasMutation;\r\n}(Mutation));\r\nexports.ModBiasMutation = ModBiasMutation;\r\nvar ModActivationMutation = /** @class */ (function (_super) {\r\n    __extends(ModActivationMutation, _super);\r\n    function ModActivationMutation(mutateOutput) {\r\n        if (mutateOutput === void 0) { mutateOutput = false; }\r\n        var _this = _super.call(this) || this;\r\n        _this.mutateOutput = mutateOutput;\r\n        return _this;\r\n    }\r\n    ModActivationMutation.prototype.mutate = function (genome, max) {\r\n        var possible = this.mutateOutput\r\n            ? genome.nodes.filter(function (node) { return node.type !== Node_1.NodeType.INPUT; })\r\n            : genome.nodes.filter(function (node) { return node.type === Node_1.NodeType.HIDDEN; });\r\n        if (possible.length > 0) {\r\n            Utils_1.pickRandom(possible).mutateActivation();\r\n        }\r\n    };\r\n    return ModActivationMutation;\r\n}(Mutation));\r\nexports.ModActivationMutation = ModActivationMutation;\r\nvar AddSelfConnectionMutation = /** @class */ (function (_super) {\r\n    __extends(AddSelfConnectionMutation, _super);\r\n    function AddSelfConnectionMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AddSelfConnectionMutation.prototype.mutate = function (genome) {\r\n        var possible = genome.nodes\r\n            .filter(function (node) { return node.type !== Node_1.NodeType.INPUT; })\r\n            .filter(function (node) { return node.selfConnection.weight === 0; });\r\n        if (possible) {\r\n            var node = Utils_1.pickRandom(possible);\r\n            genome.connect(node, node);\r\n        }\r\n    };\r\n    return AddSelfConnectionMutation;\r\n}(Mutation));\r\nexports.AddSelfConnectionMutation = AddSelfConnectionMutation;\r\nvar SubSelfConnectionMutation = /** @class */ (function (_super) {\r\n    __extends(SubSelfConnectionMutation, _super);\r\n    function SubSelfConnectionMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SubSelfConnectionMutation.prototype.mutate = function (genome) {\r\n        var possible = genome.connections.filter(function (conn) { return conn.from === conn.to; });\r\n        if (possible.length > 0) {\r\n            var randomConnection = Utils_1.pickRandom(possible);\r\n            genome.disconnect(randomConnection.from, randomConnection.to);\r\n        }\r\n    };\r\n    return SubSelfConnectionMutation;\r\n}(Mutation));\r\nexports.SubSelfConnectionMutation = SubSelfConnectionMutation;\r\nvar AddGateMutation = /** @class */ (function (_super) {\r\n    __extends(AddGateMutation, _super);\r\n    function AddGateMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AddGateMutation.prototype.mutate = function (genome, maxGates) {\r\n        if (maxGates !== undefined && maxGates <= genome.gates.length) {\r\n            return;\r\n        }\r\n        var possible = genome.connections.filter(function (conn) { return conn.gateNode === null; });\r\n        if (possible.length > 0) {\r\n            var node = Utils_1.pickRandom(genome.nodes.filter(function (node) { return node.type !== Node_1.NodeType.INPUT; }));\r\n            var connection = Utils_1.pickRandom(possible);\r\n            genome.addGate(node, connection);\r\n        }\r\n    };\r\n    return AddGateMutation;\r\n}(Mutation));\r\nexports.AddGateMutation = AddGateMutation;\r\nvar SubGateMutation = /** @class */ (function (_super) {\r\n    __extends(SubGateMutation, _super);\r\n    function SubGateMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SubGateMutation.prototype.mutate = function (genome) {\r\n        if (genome.gates.length > 0) {\r\n            genome.removeGate(Utils_1.pickRandom(genome.gates));\r\n        }\r\n    };\r\n    return SubGateMutation;\r\n}(Mutation));\r\nexports.SubGateMutation = SubGateMutation;\r\nvar AddBackConnectionMutation = /** @class */ (function (_super) {\r\n    __extends(AddBackConnectionMutation, _super);\r\n    function AddBackConnectionMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AddBackConnectionMutation.prototype.mutate = function (genome) {\r\n        var possible = [];\r\n        for (var i = genome.inputSize; i < genome.nodes.length; i++) {\r\n            var from = genome.nodes[i];\r\n            for (var j = genome.inputSize; j < i; j++) {\r\n                var to = genome.nodes[j];\r\n                if (!from.isProjectingTo(to)) {\r\n                    possible.push([from, to]);\r\n                }\r\n            }\r\n        }\r\n        if (possible.length > 0) {\r\n            var pair = Utils_1.pickRandom(possible);\r\n            genome.connect(pair[0], pair[1]);\r\n        }\r\n    };\r\n    return AddBackConnectionMutation;\r\n}(Mutation));\r\nexports.AddBackConnectionMutation = AddBackConnectionMutation;\r\nvar SubBackConnectionMutation = /** @class */ (function (_super) {\r\n    __extends(SubBackConnectionMutation, _super);\r\n    function SubBackConnectionMutation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SubBackConnectionMutation.prototype.mutate = function (genome) {\r\n        var possible = genome.connections\r\n            .filter(function (conn) { return conn.from.outgoing.length > 1; })\r\n            .filter(function (conn) { return conn.to.incoming.length > 1; })\r\n            .filter(function (conn) { return genome.nodes.indexOf(conn.from) > genome.nodes.indexOf(conn.to); });\r\n        if (possible.length > 0) {\r\n            var randomConnection = Utils_1.pickRandom(possible);\r\n            genome.disconnect(randomConnection.from, randomConnection.to);\r\n        }\r\n    };\r\n    return SubBackConnectionMutation;\r\n}(Mutation));\r\nexports.SubBackConnectionMutation = SubBackConnectionMutation;\r\nvar SwapNodesMutation = /** @class */ (function (_super) {\r\n    __extends(SwapNodesMutation, _super);\r\n    function SwapNodesMutation(mutateOutput) {\r\n        if (mutateOutput === void 0) { mutateOutput = false; }\r\n        var _this = _super.call(this) || this;\r\n        _this.mutateOutput = mutateOutput;\r\n        return _this;\r\n    }\r\n    SwapNodesMutation.prototype.mutate = function (genome) {\r\n        var possible = this.mutateOutput\r\n            ? genome.nodes.filter(function (node) { return node !== undefined && node.type !== Node_1.NodeType.INPUT; })\r\n            : genome.nodes.filter(function (node) { return node !== undefined && node.type === Node_1.NodeType.HIDDEN; });\r\n        if (possible.length >= 2) {\r\n            var node1_1 = Utils_1.pickRandom(possible);\r\n            var node2 = Utils_1.pickRandom(possible.filter(function (node) { return node !== node1_1; }));\r\n            var biasTemp = node1_1.bias;\r\n            var squashTemp = node1_1.squash;\r\n            node1_1.bias = node2.bias;\r\n            node1_1.squash = node2.squash;\r\n            node2.bias = biasTemp;\r\n            node2.squash = squashTemp;\r\n        }\r\n    };\r\n    return SwapNodesMutation;\r\n}(Mutation));\r\nexports.SwapNodesMutation = SwapNodesMutation;\r\nexports.ALL_MUTATIONS = [\r\n    new AddNodeMutation(),\r\n    new SubNodeMutation(),\r\n    new AddConnectionMutation(),\r\n    new SubConnectionMutation(),\r\n    new ModWeightMutation(),\r\n    new ModBiasMutation(),\r\n    new ModActivationMutation(),\r\n    new AddGateMutation(),\r\n    new SubGateMutation(),\r\n    new AddSelfConnectionMutation(),\r\n    new SubSelfConnectionMutation(),\r\n    new AddBackConnectionMutation(),\r\n    new SubBackConnectionMutation(),\r\n    new SwapNodesMutation(),\r\n];\r\nexports.FEEDFORWARD_MUTATIONS = [\r\n    new AddNodeMutation(),\r\n    new SubNodeMutation(),\r\n    new AddConnectionMutation(),\r\n    new SubConnectionMutation(),\r\n    new ModWeightMutation(),\r\n    new ModBiasMutation(),\r\n    new ModActivationMutation(),\r\n    new SwapNodesMutation(),\r\n];\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Loss = /** @class */ (function () {\r\n    function Loss() {\r\n    }\r\n    return Loss;\r\n}());\r\nexports.Loss = Loss;\r\nvar CrossEntropyLoss = /** @class */ (function (_super) {\r\n    __extends(CrossEntropyLoss, _super);\r\n    function CrossEntropyLoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    CrossEntropyLoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach((function (value, index) {\r\n            error -= targets[index] * Math.log(Math.max(value, 1e-15)) + (1 - targets[index]) * Math.log(1 - Math.max(value, 1e-15));\r\n        }));\r\n        return error / outputs.length;\r\n    };\r\n    return CrossEntropyLoss;\r\n}(Loss));\r\nexports.CrossEntropyLoss = CrossEntropyLoss;\r\nvar MSELoss = /** @class */ (function (_super) {\r\n    __extends(MSELoss, _super);\r\n    function MSELoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MSELoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach((function (value, index) {\r\n            error += Math.pow(targets[index] - value, 2);\r\n        }));\r\n        return error / outputs.length;\r\n    };\r\n    return MSELoss;\r\n}(Loss));\r\nexports.MSELoss = MSELoss;\r\nvar BinaryLoss = /** @class */ (function (_super) {\r\n    __extends(BinaryLoss, _super);\r\n    function BinaryLoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    BinaryLoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach((function (value, index) {\r\n            error += Math.round(targets[index] * 2) !== Math.round(value * 2) ? 1 : 0;\r\n        }));\r\n        return error / outputs.length;\r\n    };\r\n    return BinaryLoss;\r\n}(Loss));\r\nexports.BinaryLoss = BinaryLoss;\r\nvar MAELoss = /** @class */ (function (_super) {\r\n    __extends(MAELoss, _super);\r\n    function MAELoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MAELoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach((function (value, index) {\r\n            error += Math.abs(targets[index] - value);\r\n        }));\r\n        return error / outputs.length;\r\n    };\r\n    return MAELoss;\r\n}(Loss));\r\nexports.MAELoss = MAELoss;\r\nvar MAPELoss = /** @class */ (function (_super) {\r\n    __extends(MAPELoss, _super);\r\n    function MAPELoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MAPELoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach((function (value, index) {\r\n            error += Math.abs((value - targets[index]) / Math.max(targets[index], 1e-15));\r\n        }));\r\n        return error / outputs.length;\r\n    };\r\n    return MAPELoss;\r\n}(Loss));\r\nexports.MAPELoss = MAPELoss;\r\nvar WAPELoss = /** @class */ (function (_super) {\r\n    __extends(WAPELoss, _super);\r\n    function WAPELoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WAPELoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        var sum = 0;\r\n        for (var i = 0; i < outputs.length; i++) {\r\n            error += Math.abs(targets[i] - outputs[i]);\r\n            sum += targets[i];\r\n        }\r\n        return error / sum;\r\n    };\r\n    return WAPELoss;\r\n}(Loss));\r\nexports.WAPELoss = WAPELoss;\r\nvar MSLELoss = /** @class */ (function (_super) {\r\n    __extends(MSLELoss, _super);\r\n    function MSLELoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MSLELoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach((function (value, index) {\r\n            error += Math.log(Math.max(targets[index], 1e-15)) - Math.log(Math.max(value, 1e-15));\r\n        }));\r\n        return error / outputs.length;\r\n    };\r\n    return MSLELoss;\r\n}(Loss));\r\nexports.MSLELoss = MSLELoss;\r\nvar HINGELoss = /** @class */ (function (_super) {\r\n    __extends(HINGELoss, _super);\r\n    function HINGELoss() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    HINGELoss.prototype.calc = function (targets, outputs) {\r\n        var error = 0;\r\n        outputs.forEach(function (value, index) {\r\n            error += Math.max(0, 1 - value * targets[index]);\r\n        });\r\n        return error / outputs.length;\r\n    };\r\n    return HINGELoss;\r\n}(Loss));\r\nexports.HINGELoss = HINGELoss;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Rate = /** @class */ (function () {\r\n    function Rate(baseRate) {\r\n        this.baseRate = baseRate;\r\n    }\r\n    return Rate;\r\n}());\r\nexports.Rate = Rate;\r\nvar FixedRate = /** @class */ (function (_super) {\r\n    __extends(FixedRate, _super);\r\n    function FixedRate() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    FixedRate.prototype.calc = function (iteration) {\r\n        return this.baseRate;\r\n    };\r\n    return FixedRate;\r\n}(Rate));\r\nexports.FixedRate = FixedRate;\r\nvar StepRate = /** @class */ (function (_super) {\r\n    __extends(StepRate, _super);\r\n    function StepRate(baseRate, gamma, stepSize) {\r\n        if (gamma === void 0) { gamma = 0.9; }\r\n        if (stepSize === void 0) { stepSize = 100; }\r\n        var _this = _super.call(this, baseRate) || this;\r\n        _this.gamma = gamma;\r\n        _this.stepSize = stepSize;\r\n        return _this;\r\n    }\r\n    StepRate.prototype.calc = function (iteration) {\r\n        return this.baseRate * Math.pow(this.gamma, Math.floor(iteration / this.stepSize));\r\n    };\r\n    return StepRate;\r\n}(Rate));\r\nexports.StepRate = StepRate;\r\nvar ExponentialRate = /** @class */ (function (_super) {\r\n    __extends(ExponentialRate, _super);\r\n    function ExponentialRate(baseRate, gamma) {\r\n        if (gamma === void 0) { gamma = 0.999; }\r\n        var _this = _super.call(this, baseRate) || this;\r\n        _this.gamma = gamma;\r\n        return _this;\r\n    }\r\n    ExponentialRate.prototype.calc = function (iteration) {\r\n        return this.baseRate * Math.pow(this.gamma, iteration);\r\n    };\r\n    return ExponentialRate;\r\n}(Rate));\r\nexports.ExponentialRate = ExponentialRate;\r\nvar InverseRate = /** @class */ (function (_super) {\r\n    __extends(InverseRate, _super);\r\n    function InverseRate(baseRate, gamma, power) {\r\n        if (gamma === void 0) { gamma = 0.001; }\r\n        if (power === void 0) { power = 2; }\r\n        var _this = _super.call(this, baseRate) || this;\r\n        _this.gamma = gamma;\r\n        _this.power = power;\r\n        return _this;\r\n    }\r\n    InverseRate.prototype.calc = function (iteration) {\r\n        return this.baseRate * Math.pow(1 + this.gamma * iteration, -this.power);\r\n    };\r\n    return InverseRate;\r\n}(Rate));\r\nexports.InverseRate = InverseRate;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Utils_1 = require(\"./Utils\");\r\nvar Selection = /** @class */ (function () {\r\n    function Selection() {\r\n    }\r\n    return Selection;\r\n}());\r\nexports.Selection = Selection;\r\nvar FitnessProportionateSelection = /** @class */ (function (_super) {\r\n    __extends(FitnessProportionateSelection, _super);\r\n    function FitnessProportionateSelection() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    FitnessProportionateSelection.prototype.select = function (population) {\r\n        var _a;\r\n        var totalFitness = 0;\r\n        var minimalFitness = 0;\r\n        population\r\n            .map(function (genome) { return genome.score; })\r\n            .forEach(function (score) {\r\n            minimalFitness = score !== undefined && score < minimalFitness ? score : minimalFitness;\r\n            totalFitness += score !== null && score !== void 0 ? score : 0;\r\n        });\r\n        minimalFitness = Math.abs(minimalFitness);\r\n        totalFitness += minimalFitness * population.length;\r\n        var random = Utils_1.randDouble(0, totalFitness);\r\n        var value = 0;\r\n        for (var _i = 0, population_1 = population; _i < population_1.length; _i++) {\r\n            var genome = population_1[_i];\r\n            value += ((_a = genome.score) !== null && _a !== void 0 ? _a : 0) + minimalFitness;\r\n            if (random < value) {\r\n                return genome;\r\n            }\r\n        }\r\n        return Utils_1.pickRandom(population);\r\n    };\r\n    return FitnessProportionateSelection;\r\n}(Selection));\r\nexports.FitnessProportionateSelection = FitnessProportionateSelection;\r\nvar PowerSelection = /** @class */ (function (_super) {\r\n    __extends(PowerSelection, _super);\r\n    function PowerSelection(power) {\r\n        if (power === void 0) { power = 4; }\r\n        var _this = _super.call(this) || this;\r\n        _this.power = power;\r\n        return _this;\r\n    }\r\n    PowerSelection.prototype.select = function (population) {\r\n        return population[Math.floor(Math.pow(Math.random(), this.power) * population.length)];\r\n    };\r\n    return PowerSelection;\r\n}(Selection));\r\nexports.PowerSelection = PowerSelection;\r\nvar TournamentSelection = /** @class */ (function (_super) {\r\n    __extends(TournamentSelection, _super);\r\n    function TournamentSelection(size, probability) {\r\n        if (size === void 0) { size = 5; }\r\n        if (probability === void 0) { probability = 0.5; }\r\n        var _this = _super.call(this) || this;\r\n        _this.size = size;\r\n        _this.probability = probability;\r\n        return _this;\r\n    }\r\n    TournamentSelection.prototype.select = function (population) {\r\n        if (this.size > population.length) {\r\n            throw new Error(\"Your tournament size should be lower than the population size, please change methods.selection.TOURNAMENT.size\");\r\n        }\r\n        // Create a tournament\r\n        var individuals = [];\r\n        for (var i = 0; i < this.size; i++) {\r\n            individuals.push(Utils_1.pickRandom(population));\r\n        }\r\n        // Sort the tournament individuals by score\r\n        individuals.sort(function (a, b) {\r\n            return b.score === undefined || a.score === undefined ? 0 : b.score - a.score;\r\n        });\r\n        // Select an individual\r\n        for (var i = 0; i < this.size; i++) {\r\n            if (Math.random() < this.probability || i === this.size - 1) {\r\n                return individuals[i];\r\n            }\r\n        }\r\n        return Utils_1.pickRandom(population);\r\n    };\r\n    return TournamentSelection;\r\n}(Selection));\r\nexports.TournamentSelection = TournamentSelection;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Network_1 = require(\"./architecture/Network\");\r\nvar Utils_1 = require(\"./methods/Utils\");\r\nvar Loss_1 = require(\"./methods/Loss\");\r\nvar Selection_1 = require(\"./methods/Selection\");\r\nvar Mutation_1 = require(\"./methods/Mutation\");\r\nvar NEAT = /** @class */ (function () {\r\n    function NEAT(dataset, options) {\r\n        this.dataset = dataset;\r\n        this.generation = Utils_1.getOrDefault(options.generation, 0);\r\n        this.input = Utils_1.getOrDefault(options.input, 1);\r\n        this.output = Utils_1.getOrDefault(options.output, 1);\r\n        this.equal = Utils_1.getOrDefault(options.equal, true);\r\n        this.clear = Utils_1.getOrDefault(options.clear, false);\r\n        this.populationSize = Utils_1.getOrDefault(options.populationSize, 50);\r\n        this.growth = Utils_1.getOrDefault(options.growth, 0.0001);\r\n        this.loss = Utils_1.getOrDefault(options.loss, new Loss_1.MSELoss());\r\n        this.amount = Utils_1.getOrDefault(options.amount, 1);\r\n        this.elitism = Utils_1.getOrDefault(options.elitism, 1);\r\n        this.provenance = Utils_1.getOrDefault(options.provenance, 0);\r\n        this.mutationRate = Utils_1.getOrDefault(options.mutationRate, 0.4);\r\n        this.mutationAmount = Utils_1.getOrDefault(options.mutationAmount, 1);\r\n        this.fitnessPopulation = Utils_1.getOrDefault(options.fitnessPopulation, false);\r\n        this.fitnessFunction = options.fitnessFunction;\r\n        this.selection = Utils_1.getOrDefault(options.selection, new Selection_1.PowerSelection());\r\n        this.mutations = Utils_1.getOrDefault(options.mutations, Mutation_1.FEEDFORWARD_MUTATIONS);\r\n        this.template = Utils_1.getOrDefault(options.template, new Network_1.Network(this.input, this.output));\r\n        this.maxNodes = Utils_1.getOrDefault(options.maxNodes, Infinity);\r\n        this.maxConnections = Utils_1.getOrDefault(options.maxConnections, Infinity);\r\n        this.maxGates = Utils_1.getOrDefault(options.maxGates, Infinity);\r\n        this.population = [];\r\n        this.createInitialPopulation();\r\n    }\r\n    NEAT.prototype.filterGenome = function (population, template, pickGenome, adjustGenome) {\r\n        var filtered = __spreadArrays(population); // avoid mutations\r\n        if (adjustGenome) {\r\n            filtered\r\n                .filter(function (genome) { return pickGenome(genome); })\r\n                .forEach(function (genome, index) { return filtered[index] = adjustGenome(filtered[index]); });\r\n        }\r\n        else {\r\n            filtered\r\n                .filter(function (genome) { return pickGenome(genome); })\r\n                .forEach(function (genome, index) { return filtered[index] = template.copy(); });\r\n        }\r\n        return filtered;\r\n    };\r\n    NEAT.prototype.mutateRandom = function (genome, possible) {\r\n        if (possible === void 0) { possible = this.mutations; }\r\n        var maxNodes = this.maxNodes;\r\n        var maxConnections = this.maxConnections;\r\n        var maxGates = this.maxGates;\r\n        possible = possible.filter(function (method) {\r\n            return (method.constructor.name !== Mutation_1.AddNodeMutation.constructor.name || genome.nodes.length < maxNodes ||\r\n                method.constructor.name !== Mutation_1.AddConnectionMutation.constructor.name || genome.connections.length < maxConnections ||\r\n                method.constructor.name !== Mutation_1.AddGateMutation.constructor.name || genome.gates.length < maxGates);\r\n        });\r\n        genome.mutate(Utils_1.pickRandom(possible));\r\n    };\r\n    NEAT.prototype.evolve = function (pickGenome, adjustGenome) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var elitists, i, newPopulation, i, fittest;\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        // Check if evolve is possible\r\n                        if (this.elitism + this.provenance > this.populationSize) {\r\n                            throw new Error(\"Can`t evolve! Elitism + provenance exceeds population size!\");\r\n                        }\r\n                        if (!(this.population[this.population.length - 1].score === undefined)) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.evaluate(this.dataset)];\r\n                    case 1:\r\n                        _b.sent();\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        if (pickGenome) {\r\n                            this.population = this.filterGenome(this.population, this.template, pickGenome, adjustGenome);\r\n                        }\r\n                        // Sort in order of fitness (fittest first)\r\n                        this.sort();\r\n                        elitists = [];\r\n                        for (i = 0; i < this.elitism; i++) {\r\n                            elitists.push(this.population[i]);\r\n                        }\r\n                        newPopulation = Array(this.provenance).fill(this.template.copy());\r\n                        // Breed the next individuals\r\n                        for (i = 0; i < this.populationSize - this.elitism - this.provenance; i++) {\r\n                            newPopulation.push(this.getOffspring());\r\n                        }\r\n                        // Replace the old population with the new population\r\n                        this.population = newPopulation;\r\n                        // Mutate the new population\r\n                        this.mutate(undefined);\r\n                        // Add the elitists\r\n                        (_a = this.population).push.apply(_a, elitists);\r\n                        // evaluate the population\r\n                        return [4 /*yield*/, this.evaluate(this.dataset)];\r\n                    case 3:\r\n                        // evaluate the population\r\n                        _b.sent();\r\n                        // Check & adjust genomes as needed\r\n                        if (pickGenome) {\r\n                            this.population = this.filterGenome(this.population, this.template, pickGenome, adjustGenome);\r\n                        }\r\n                        // Sort in order of fitness (fittest first)\r\n                        this.sort();\r\n                        fittest = this.population[0].copy();\r\n                        fittest.score = this.population[0].score;\r\n                        // Reset the scores\r\n                        this.population.forEach(function (genome) { return genome.score = undefined; });\r\n                        this.generation++;\r\n                        return [2 /*return*/, fittest];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    NEAT.prototype.getOffspring = function () {\r\n        this.sort();\r\n        var parent1 = this.selection.select(this.population);\r\n        var parent2 = this.selection.select(this.population);\r\n        if (parent1 === null || parent2 === null) {\r\n            throw new ReferenceError(\"Should not be null!\");\r\n        }\r\n        return Network_1.Network.crossOver(parent1, parent2, this.equal);\r\n    };\r\n    NEAT.prototype.mutate = function (method) {\r\n        var _this = this;\r\n        if (method) {\r\n            // Elitist genomes should not be included\r\n            this.population\r\n                .filter(function () { return Math.random() <= _this.mutationRate; })\r\n                .forEach(function (genome) {\r\n                for (var i = 0; i < _this.mutationAmount; i++) {\r\n                    genome.mutate(method);\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            // Elitist genomes should not be included\r\n            this.population\r\n                .filter(function () { return Math.random() <= _this.mutationRate; })\r\n                .forEach(function (genome) {\r\n                for (var i = 0; i < _this.mutationAmount; i++) {\r\n                    _this.mutateRandom(genome, _this.mutations);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    NEAT.prototype.evaluate = function (dataset) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _i, _a, genome;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (!this.fitnessPopulation) return [3 /*break*/, 3];\r\n                        if (this.clear) {\r\n                            this.population.forEach(function (genome) { return genome.clear(); });\r\n                        }\r\n                        if (!this.fitnessFunction) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.fitnessFunction(dataset, this.population)];\r\n                    case 1:\r\n                        _b.sent();\r\n                        _b.label = 2;\r\n                    case 2: return [3 /*break*/, 7];\r\n                    case 3:\r\n                        _i = 0, _a = this.population;\r\n                        _b.label = 4;\r\n                    case 4:\r\n                        if (!(_i < _a.length)) return [3 /*break*/, 7];\r\n                        genome = _a[_i];\r\n                        if (this.clear) {\r\n                            genome.clear();\r\n                        }\r\n                        if (!this.fitnessFunction) return [3 /*break*/, 6];\r\n                        return [4 /*yield*/, this.fitnessFunction(dataset, genome)];\r\n                    case 5:\r\n                        _b.sent();\r\n                        _b.label = 6;\r\n                    case 6:\r\n                        _i++;\r\n                        return [3 /*break*/, 4];\r\n                    case 7:\r\n                        // Sort the population in order of fitness\r\n                        this.sort();\r\n                        return [2 /*return*/, this.population[0]];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    NEAT.prototype.sort = function () {\r\n        this.population.sort(function (a, b) {\r\n            return a.score === undefined || b.score === undefined ? 0 : b.score - a.score;\r\n        });\r\n    };\r\n    NEAT.prototype.getFittest = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(this.population[this.population.length - 1].score === undefined)) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.evaluate(this.dataset)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2:\r\n                        this.sort();\r\n                        return [2 /*return*/, this.population[0]];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    NEAT.prototype.getAverage = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var score;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!(this.population[this.population.length - 1].score === undefined)) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.evaluate(this.dataset)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2:\r\n                        score = 0;\r\n                        this.population\r\n                            .map(function (genome) { return genome.score; })\r\n                            .forEach(function (val) { return score += val !== null && val !== void 0 ? val : 0; });\r\n                        return [2 /*return*/, score / this.population.length];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    NEAT.prototype.createInitialPopulation = function () {\r\n        for (var i = 0; i < this.populationSize; i++) {\r\n            this.population.push(this.template.copy());\r\n        }\r\n    };\r\n    return NEAT;\r\n}());\r\nexports.NEAT = NEAT;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Connection_1 = require(\"./Connection\");\r\nvar Node_1 = require(\"./Node\");\r\nvar Utils_1 = require(\"../methods/Utils\");\r\nvar Mutation_1 = require(\"../methods/Mutation\");\r\nvar Loss_1 = require(\"../methods/Loss\");\r\nvar Rate_1 = require(\"../methods/Rate\");\r\nvar NEAT_1 = require(\"../NEAT\");\r\nvar Network = /** @class */ (function () {\r\n    function Network(inputSize, outputSize) {\r\n        this.inputSize = inputSize;\r\n        this.outputSize = outputSize;\r\n        this.nodes = [];\r\n        this.connections = [];\r\n        this.gates = [];\r\n        this.score = undefined;\r\n        for (var i = 0; i < inputSize; i++) {\r\n            this.nodes.push(new Node_1.Node(Node_1.NodeType.INPUT));\r\n        }\r\n        for (var i = 0; i < outputSize; i++) {\r\n            this.nodes.push(new Node_1.Node(Node_1.NodeType.OUTPUT));\r\n        }\r\n        for (var i = 0; i < this.inputSize; i++) {\r\n            for (var j = this.inputSize; j < this.outputSize + this.inputSize; j++) {\r\n                var weight = (Math.random() - 0.5) * this.inputSize * Math.sqrt(2 / this.inputSize);\r\n                this.connect(this.nodes[i], this.nodes[j], weight);\r\n            }\r\n        }\r\n    }\r\n    Network.fromJSON = function (json) {\r\n        var network = new Network(json.inputSize, json.outputSize);\r\n        network.nodes = [];\r\n        network.connections = [];\r\n        json.nodes.forEach(function (nodeJSON) {\r\n            var node = Node_1.Node.fromJSON(nodeJSON);\r\n            network.nodes[node.index] = node;\r\n        });\r\n        json.connections.forEach(function (jsonConnection) {\r\n            var connection = network.connect(network.nodes[jsonConnection.fromIndex], network.nodes[jsonConnection.toIndex], jsonConnection.weight);\r\n            if (jsonConnection.gateNodeIndex != null) {\r\n                network.addGate(network.nodes[jsonConnection.gateNodeIndex], connection);\r\n            }\r\n        });\r\n        return network;\r\n    };\r\n    Network.crossOver = function (network1, network2, equal) {\r\n        if (network1.inputSize !== network2.inputSize || network1.outputSize !== network2.outputSize) {\r\n            throw new Error(\"Networks don`t have the same input/output size!\");\r\n        }\r\n        // Initialise offspring\r\n        var offspring = new Network(network1.inputSize, network1.outputSize);\r\n        offspring.connections = [];\r\n        offspring.nodes = [];\r\n        // Save scores and create a copy\r\n        var score1 = network1.score || 0;\r\n        var score2 = network2.score || 0;\r\n        // Determine offspring node size\r\n        var offspringSize;\r\n        if (equal || score1 === score2) {\r\n            var max = Math.max(network1.nodes.length, network2.nodes.length);\r\n            var min = Math.min(network1.nodes.length, network2.nodes.length);\r\n            offspringSize = Utils_1.randInt(min, max + 1);\r\n        }\r\n        else if (score1 > score2) {\r\n            offspringSize = network1.nodes.length;\r\n        }\r\n        else {\r\n            offspringSize = network2.nodes.length;\r\n        }\r\n        var inputSize = network1.inputSize;\r\n        var outputSize = network1.outputSize;\r\n        for (var i = 0; i < network1.nodes.length; i++) {\r\n            network1.nodes[i].index = i;\r\n        }\r\n        for (var i = 0; i < network2.nodes.length; i++) {\r\n            network2.nodes[i].index = i;\r\n        }\r\n        // Assign nodes from parents to offspring\r\n        for (var i = 0; i < offspringSize; i++) {\r\n            var chosenNode = void 0;\r\n            var chosenNodeType = null;\r\n            if (i < inputSize) {\r\n                chosenNodeType = Node_1.NodeType.INPUT;\r\n                var sourceNetwork = Utils_1.randBoolean() ? network1 : network2;\r\n                var inputNumber = -1;\r\n                var j = -1;\r\n                while (inputNumber < i) {\r\n                    j++;\r\n                    if (j >= sourceNetwork.nodes.length) {\r\n                        // something is wrong...\r\n                        throw RangeError('something is wrong with the size of the input');\r\n                    }\r\n                    if (sourceNetwork.nodes[j].type === Node_1.NodeType.INPUT) {\r\n                        inputNumber++;\r\n                    }\r\n                }\r\n                chosenNode = sourceNetwork.nodes[j];\r\n            }\r\n            else if (i < inputSize + outputSize) { // now select output nodes\r\n                chosenNodeType = Node_1.NodeType.OUTPUT;\r\n                var sourceNetwork = Utils_1.randBoolean() ? network1 : network2;\r\n                var outputNumber = -1;\r\n                var j = -1;\r\n                while (outputNumber < i - inputSize) {\r\n                    j++;\r\n                    if (j >= sourceNetwork.nodes.length) {\r\n                        throw RangeError('something is wrong with the size of the output');\r\n                    }\r\n                    if (sourceNetwork.nodes[j].type === Node_1.NodeType.OUTPUT) {\r\n                        outputNumber++;\r\n                    }\r\n                }\r\n                chosenNode = sourceNetwork.nodes[j];\r\n            }\r\n            else {\r\n                chosenNodeType = Node_1.NodeType.HIDDEN;\r\n                var sourceNetwork = void 0;\r\n                if (i >= network1.nodes.length) {\r\n                    sourceNetwork = network2;\r\n                }\r\n                else if (i >= network2.nodes.length) {\r\n                    sourceNetwork = network1;\r\n                }\r\n                else {\r\n                    sourceNetwork = Utils_1.randBoolean() ? network1 : network2;\r\n                }\r\n                chosenNode = Utils_1.pickRandom(sourceNetwork.nodes);\r\n            }\r\n            var newNode = new Node_1.Node(chosenNode.type);\r\n            newNode.bias = chosenNode.bias;\r\n            newNode.squash = chosenNode.squash;\r\n            offspring.nodes.push(newNode);\r\n        }\r\n        // Create arrays of connection genes\r\n        var n1connections = [];\r\n        var n2connections = [];\r\n        // Add the connections of network 1\r\n        network1.connections.forEach(function (connection) {\r\n            n1connections[Connection_1.Connection.innovationID(connection.from.index, connection.to.index)] = connection.toJSON();\r\n        });\r\n        // Add the connections of network 2\r\n        network2.connections.forEach(function (connection) {\r\n            n2connections[Connection_1.Connection.innovationID(connection.from.index, connection.to.index)] = connection.toJSON();\r\n        });\r\n        // Split common conn genes from disjoint or excess conn genes\r\n        var connections = [];\r\n        var keys1 = Object.keys(n1connections);\r\n        var keys2 = Object.keys(n2connections);\r\n        for (var i = keys1.length - 1; i >= 0; i--) {\r\n            if (n2connections[parseInt(keys1[i])] !== undefined) {\r\n                connections.push(Utils_1.randBoolean() ? n1connections[parseInt(keys1[i])] : n2connections[parseInt(keys1[i])]);\r\n                n2connections[parseInt(keys1[i])] = undefined;\r\n            }\r\n            else if (score1 >= score2 || equal) {\r\n                connections.push(n1connections[parseInt(keys1[i])]);\r\n            }\r\n        }\r\n        // Excess/disjoint gene\r\n        if (score2 >= score1 || equal) {\r\n            keys2\r\n                .map(function (key) { return parseInt(key); })\r\n                .map(function (key) { return n2connections[key]; })\r\n                .filter(function (conn) { return conn !== undefined; })\r\n                .forEach(function (conn) { return connections.push(conn); });\r\n        }\r\n        // Add common conn genes uniformly\r\n        connections.forEach(function (connectionJSON) {\r\n            if (connectionJSON !== undefined && connectionJSON.toIndex < offspringSize && connectionJSON.fromIndex < offspringSize) {\r\n                var from = offspring.nodes[connectionJSON.fromIndex];\r\n                var to = offspring.nodes[connectionJSON.toIndex];\r\n                var connection = offspring.connect(from, to, connectionJSON.weight);\r\n                if (connectionJSON.gateNodeIndex !== null && connectionJSON.gateNodeIndex < offspringSize) {\r\n                    offspring.addGate(offspring.nodes[connectionJSON.gateNodeIndex], connection);\r\n                }\r\n            }\r\n        });\r\n        return offspring;\r\n    };\r\n    Network.prototype.copy = function () {\r\n        return Network.fromJSON(this.toJSON());\r\n    };\r\n    Network.prototype.connect = function (from, to, weight) {\r\n        if (weight === void 0) { weight = 0; }\r\n        var connection = from.connect(to, weight);\r\n        this.connections.push(connection);\r\n        return connection;\r\n    };\r\n    Network.prototype.activate = function (input, dropoutRate, trace) {\r\n        if (dropoutRate === void 0) { dropoutRate = 0; }\r\n        if (trace === void 0) { trace = true; }\r\n        var inputNodeIndex = 0;\r\n        for (var _i = 0, _a = this.nodes; _i < _a.length; _i++) {\r\n            var node = _a[_i];\r\n            if (inputNodeIndex === this.inputSize) {\r\n                break;\r\n            }\r\n            if (node.type !== Node_1.NodeType.INPUT) {\r\n                continue;\r\n            }\r\n            node.activate(input[inputNodeIndex++], trace);\r\n        }\r\n        if (inputNodeIndex !== input.length) {\r\n            throw Error(\"There are \" + inputNodeIndex + \" input nodes, but \" + input.length + \" inputs were passed\");\r\n        }\r\n        this.nodes\r\n            .filter(function (node) { return node.type === Node_1.NodeType.HIDDEN; })\r\n            .forEach(function (node) {\r\n            if (dropoutRate) {\r\n                node.mask = Math.random() >= dropoutRate ? 1 : 0;\r\n            }\r\n            node.activate(undefined, trace);\r\n        });\r\n        var output = [];\r\n        for (var _b = 0, _c = this.nodes; _b < _c.length; _b++) {\r\n            var node = _c[_b];\r\n            if (output.length === this.outputSize) {\r\n                break;\r\n            }\r\n            if (node.type !== Node_1.NodeType.OUTPUT) {\r\n                continue;\r\n            }\r\n            output.push(node.activate(undefined, trace));\r\n        }\r\n        if (output.length !== this.outputSize) {\r\n            throw Error(\"There are \" + this.outputSize + \" output nodes, but \" + output.length + \" outputs were passed\");\r\n        }\r\n        return output;\r\n    };\r\n    Network.prototype.propagate = function (rate, momentum, update, target) {\r\n        if (target.length !== this.outputSize) {\r\n            throw new Error(\"Output target length should match network output length\");\r\n        }\r\n        var targetIndex = 0;\r\n        for (var i = 0; targetIndex < this.outputSize; i++) {\r\n            if (this.nodes[i].type === Node_1.NodeType.OUTPUT) {\r\n                this.nodes[i].propagate(target[targetIndex++], momentum, rate, update);\r\n            }\r\n        }\r\n        for (var i = this.nodes.length - 1; i >= 0; i--) {\r\n            if (this.nodes[i].type === Node_1.NodeType.HIDDEN) {\r\n                this.nodes[i].propagate(undefined, rate, momentum, update);\r\n            }\r\n        }\r\n        this.nodes\r\n            .filter(function (node) { return node.type === Node_1.NodeType.INPUT; })\r\n            .forEach(function (node) {\r\n            node.propagate(undefined, rate, momentum, update);\r\n        });\r\n    };\r\n    Network.prototype.clear = function () {\r\n        this.nodes.forEach(function (node) { return node.clear(); });\r\n    };\r\n    Network.prototype.disconnect = function (from, to) {\r\n        var _this = this;\r\n        this.connections\r\n            .filter(function (conn) { return conn.from === from; })\r\n            .filter(function (conn) { return conn.to === to; })\r\n            .forEach(function (conn) {\r\n            if (conn.gateNode !== null) {\r\n                _this.removeGate(conn);\r\n            }\r\n            Utils_1.remove(_this.connections, conn);\r\n        });\r\n        return from.disconnect(to);\r\n    };\r\n    Network.prototype.addGate = function (node, connection) {\r\n        if (this.nodes.indexOf(node) === -1) {\r\n            throw new ReferenceError(\"This node is not part of the network!\");\r\n        }\r\n        else if (connection.gateNode != null) {\r\n            return;\r\n        }\r\n        node.addGate(connection);\r\n        this.gates.push(connection);\r\n    };\r\n    Network.prototype.removeGate = function (connection) {\r\n        if (!Utils_1.anyMatch(this.gates, connection)) {\r\n            throw new Error(\"This connection is not gated!\");\r\n        }\r\n        Utils_1.remove(this.gates, connection);\r\n        if (connection.gateNode != null) {\r\n            connection.gateNode.removeGate(connection);\r\n        }\r\n    };\r\n    Network.prototype.removeNode = function (node, keepGates) {\r\n        var _this = this;\r\n        if (keepGates === void 0) { keepGates = new Mutation_1.SubNodeMutation().keepGates; }\r\n        if (!Utils_1.anyMatch(this.nodes, node)) {\r\n            throw new ReferenceError(\"This node does not exist in the network!\");\r\n        }\r\n        this.disconnect(node, node);\r\n        var inputs = [];\r\n        var gates = [];\r\n        var outputs = [];\r\n        for (var i = node.incoming.length - 1; i >= 0; i--) {\r\n            var connection = node.incoming[i];\r\n            if (keepGates && connection.gateNode !== null && connection.gateNode !== node) {\r\n                gates.push(connection.gateNode);\r\n            }\r\n            inputs.push(connection.from);\r\n            this.disconnect(connection.from, node);\r\n        }\r\n        for (var i = node.outgoing.length - 1; i >= 0; i--) {\r\n            var connection = node.outgoing[i];\r\n            if (keepGates && connection.gateNode !== null && connection.gateNode !== node) {\r\n                gates.push(connection.gateNode);\r\n            }\r\n            outputs.push(connection.to);\r\n            this.disconnect(node, connection.to);\r\n        }\r\n        var connections = [];\r\n        inputs.forEach(function (input) {\r\n            outputs.forEach(function (output) {\r\n                if (!input.isProjectingTo(output)) {\r\n                    connections.push(_this.connect(input, output));\r\n                }\r\n            });\r\n        });\r\n        while (gates.length > 0 && connections.length > 0) {\r\n            var gate = gates.shift();\r\n            if (gate === undefined) {\r\n                continue;\r\n            }\r\n            var connection = Utils_1.pickRandom(connections);\r\n            this.addGate(gate, connection);\r\n            Utils_1.remove(connections, connection);\r\n        }\r\n        for (var i = node.gated.length - 1; i >= 0; i--) {\r\n            this.removeGate(node.gated[i]);\r\n        }\r\n        Utils_1.remove(this.nodes, node);\r\n    };\r\n    Network.prototype.mutate = function (method, maxNodes, maxConnections, maxGates) {\r\n        if (maxNodes === void 0) { maxNodes = Infinity; }\r\n        if (maxConnections === void 0) { maxConnections = Infinity; }\r\n        if (maxGates === void 0) { maxGates = Infinity; }\r\n        var _a;\r\n        method.mutate(this, (_a = maxNodes !== null && maxNodes !== void 0 ? maxNodes : maxConnections) !== null && _a !== void 0 ? _a : maxGates);\r\n    };\r\n    Network.prototype.mutateRandom = function (allowedMethods, maxNodes, maxConnections, maxGates) {\r\n        if (allowedMethods === void 0) { allowedMethods = Mutation_1.ALL_MUTATIONS; }\r\n        if (maxNodes === void 0) { maxNodes = Infinity; }\r\n        if (maxConnections === void 0) { maxConnections = Infinity; }\r\n        if (maxGates === void 0) { maxGates = Infinity; }\r\n        if (allowedMethods.length === 0) {\r\n            return;\r\n        }\r\n        this.mutate(Utils_1.pickRandom(allowedMethods), maxNodes || Infinity, maxConnections || Infinity, maxGates || Infinity);\r\n    };\r\n    Network.prototype.train = function (dataset, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _a;\r\n        if (dataset[0].input.length !== this.inputSize || dataset[0].output.length !== this.outputSize) {\r\n            throw new Error(\"Dataset input/output size should be same as network input/output size!\");\r\n        }\r\n        options.iterations = Utils_1.getOrDefault(options.iterations, 100);\r\n        options.error = Utils_1.getOrDefault(options.error, 0.05);\r\n        options.loss = Utils_1.getOrDefault(options.loss, new Loss_1.MSELoss());\r\n        var baseRate = Utils_1.getOrDefault(options.rate, 0.3);\r\n        options.dropout = Utils_1.getOrDefault(options.dropout, 0);\r\n        options.momentum = Utils_1.getOrDefault(options.momentum, 0);\r\n        options.batchSize = Math.min(dataset.length, Utils_1.getOrDefault(options.batchSize, 1));\r\n        options.ratePolicy = Utils_1.getOrDefault(options.ratePolicy, new Rate_1.FixedRate(baseRate));\r\n        options.log = Utils_1.getOrDefault(options.log, NaN);\r\n        var targetError = options.error <= 0 ? -1 : options.error;\r\n        var start = Date.now();\r\n        // check for errors\r\n        if (options.iterations <= 0 && options.error <= 0) {\r\n            throw new Error(\"At least one of the following options must be specified: error, iterations\");\r\n        }\r\n        var trainingSetSize;\r\n        var trainingSet;\r\n        var testSet;\r\n        if (options.crossValidateTestSize && options.crossValidateTestSize > 0) {\r\n            trainingSetSize = Math.ceil((1 - options.crossValidateTestSize) * dataset.length);\r\n            trainingSet = dataset.slice(0, trainingSetSize);\r\n            testSet = dataset.slice(trainingSetSize);\r\n        }\r\n        else {\r\n            trainingSet = dataset;\r\n            testSet = [];\r\n        }\r\n        var currentTrainingRate;\r\n        var iterationCount = 0;\r\n        var error = 1;\r\n        while (error > targetError && (options.iterations <= 0 || iterationCount < options.iterations)) {\r\n            iterationCount++;\r\n            currentTrainingRate = options.ratePolicy.calc(iterationCount);\r\n            var trainError = this.trainEpoch(trainingSet, options.batchSize, currentTrainingRate, options.momentum, options.loss, options.dropout);\r\n            if (options.clear) {\r\n                this.clear();\r\n            }\r\n            // Checks if cross validation is enabled\r\n            if (options.crossValidateTestSize) {\r\n                error = this.test(testSet, options.loss);\r\n                if (options.clear) {\r\n                    this.clear();\r\n                }\r\n            }\r\n            else {\r\n                error = trainError;\r\n            }\r\n            if ((_a = options.shuffle) !== null && _a !== void 0 ? _a : false) {\r\n                Utils_1.shuffle(dataset);\r\n            }\r\n            if (options.log > 0 && iterationCount % options.log === 0) {\r\n                console.log(\"iteration number\", iterationCount, \"error\", error, \"training rate\", currentTrainingRate);\r\n            }\r\n            if (options.schedule && iterationCount % options.schedule.iterations === 0) {\r\n                options.schedule.function(error, iterationCount);\r\n            }\r\n        }\r\n        if (options.clear) {\r\n            this.clear();\r\n        }\r\n        return {\r\n            error: error,\r\n            iterations: iterationCount,\r\n            time: Date.now() - start\r\n        };\r\n    };\r\n    Network.prototype.trainEpoch = function (dataset, batchSize, trainingRate, momentum, loss, dropoutRate) {\r\n        if (dropoutRate === void 0) { dropoutRate = 0.5; }\r\n        var errorSum = 0;\r\n        for (var i = 0; i < dataset.length; i++) {\r\n            var input = dataset[i].input;\r\n            var correctOutput = dataset[i].output;\r\n            var update = (i + 1) % batchSize === 0 || i + 1 === dataset.length;\r\n            var output = this.activate(input, dropoutRate);\r\n            this.propagate(trainingRate, momentum, update, correctOutput);\r\n            errorSum += loss.calc(correctOutput, output);\r\n        }\r\n        return errorSum / dataset.length;\r\n    };\r\n    Network.prototype.test = function (dataset, loss) {\r\n        if (loss === void 0) { loss = new Loss_1.MSELoss(); }\r\n        var error = 0;\r\n        for (var _i = 0, dataset_1 = dataset; _i < dataset_1.length; _i++) {\r\n            var entry = dataset_1[_i];\r\n            var input = entry.input;\r\n            var target = entry.output;\r\n            var output = this.activate(input, undefined, false);\r\n            error += loss.calc(target, output);\r\n        }\r\n        return error / dataset.length;\r\n    };\r\n    Network.prototype.toJSON = function () {\r\n        var json = {\r\n            nodes: [],\r\n            connections: [],\r\n            inputSize: this.inputSize,\r\n            outputSize: this.outputSize,\r\n        };\r\n        for (var i = 0; i < this.nodes.length; i++) {\r\n            this.nodes[i].index = i;\r\n        }\r\n        this.nodes.forEach(function (node) {\r\n            json.nodes.push(node.toJSON());\r\n            if (node.selfConnection.weight !== 0) {\r\n                json.connections.push(node.selfConnection.toJSON());\r\n            }\r\n        });\r\n        this.connections.forEach(function (conn) { return json.connections.push(conn.toJSON()); });\r\n        return json;\r\n    };\r\n    Network.prototype.evolve = function (dataset, options) {\r\n        var _a, _b, _c;\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var targetError, start, neat, error, bestFitness, bestGenome, fittest, fitness;\r\n            return __generator(this, function (_d) {\r\n                switch (_d.label) {\r\n                    case 0:\r\n                        if (dataset[0].input.length !== this.inputSize || dataset[0].output.length !== this.outputSize) {\r\n                            throw new Error(\"Dataset input/output size should be same as network input/output size!\");\r\n                        }\r\n                        targetError = 0;\r\n                        if (typeof options.iterations === \"undefined\" && typeof options.error === \"undefined\") {\r\n                            options.iterations = 1000;\r\n                            targetError = 0.05;\r\n                        }\r\n                        else if (options.iterations) {\r\n                            targetError = -1;\r\n                        }\r\n                        else if (options.error) {\r\n                            targetError = options.error;\r\n                            options.iterations = 0;\r\n                        }\r\n                        options.growth = Utils_1.getOrDefault(options.growth, 0.0001);\r\n                        options.loss = Utils_1.getOrDefault(options.loss, new Loss_1.MSELoss());\r\n                        options.amount = Utils_1.getOrDefault(options.amount, 1);\r\n                        options.fitnessPopulation = Utils_1.getOrDefault(options.fitnessPopulation, false);\r\n                        options.maxNodes = Utils_1.getOrDefault(options.maxNodes, Infinity);\r\n                        options.maxConnections = Utils_1.getOrDefault(options.maxConnections, Infinity);\r\n                        options.maxGates = Utils_1.getOrDefault(options.maxGates, Infinity);\r\n                        start = Date.now();\r\n                        options.fitnessFunction = function (dataset, population) {\r\n                            return __awaiter(this, void 0, void 0, function () {\r\n                                var _this = this;\r\n                                return __generator(this, function (_a) {\r\n                                    switch (_a.label) {\r\n                                        case 0:\r\n                                            if (!Array.isArray(population)) {\r\n                                                population = [population];\r\n                                            }\r\n                                            return [4 /*yield*/, Promise.all(population.map(function (genome) { return __awaiter(_this, void 0, void 0, function () {\r\n                                                    var score, i;\r\n                                                    var _a, _b, _c;\r\n                                                    return __generator(this, function (_d) {\r\n                                                        score = 0;\r\n                                                        for (i = 0; i < ((_a = options.amount) !== null && _a !== void 0 ? _a : 1); i++) {\r\n                                                            score -= genome.test(dataset, options.loss);\r\n                                                        }\r\n                                                        score -= (_b = options.growth) !== null && _b !== void 0 ? _b : 0.0001 * (genome.nodes.length\r\n                                                            - genome.inputSize\r\n                                                            - genome.outputSize\r\n                                                            + genome.connections.length\r\n                                                            + genome.gates.length);\r\n                                                        genome.score = score / ((_c = options.amount) !== null && _c !== void 0 ? _c : 1);\r\n                                                        return [2 /*return*/];\r\n                                                    });\r\n                                                }); }))];\r\n                                        case 1:\r\n                                            _a.sent();\r\n                                            return [2 /*return*/];\r\n                                    }\r\n                                });\r\n                            });\r\n                        };\r\n                        options.fitnessPopulation = true;\r\n                        options.template = this;\r\n                        options.input = this.inputSize;\r\n                        options.output = this.outputSize;\r\n                        neat = new NEAT_1.NEAT(dataset, options);\r\n                        error = -Infinity;\r\n                        bestFitness = -Infinity;\r\n                        _d.label = 1;\r\n                    case 1:\r\n                        if (!(error < -targetError && (options.iterations === 0 || neat.generation < ((_a = options.iterations) !== null && _a !== void 0 ? _a : 0)))) return [3 /*break*/, 3];\r\n                        return [4 /*yield*/, neat.evolve(undefined, undefined)];\r\n                    case 2:\r\n                        fittest = _d.sent();\r\n                        fitness = fittest.score === undefined ? -Infinity : fittest.score;\r\n                        error = fitness + options.growth * (fittest.nodes.length\r\n                            - fittest.inputSize\r\n                            - fittest.outputSize\r\n                            + fittest.connections.length\r\n                            + fittest.gates.length);\r\n                        if (fitness > bestFitness) {\r\n                            bestFitness = fitness;\r\n                            bestGenome = fittest;\r\n                        }\r\n                        if (((_b = options.log) !== null && _b !== void 0 ? _b : 0) > 0 && neat.generation % ((_c = options.log) !== null && _c !== void 0 ? _c : 0) === 0) {\r\n                            console.log(\"iteration\", neat.generation, \"fitness\", fitness, \"error\", -error);\r\n                        }\r\n                        if (options.schedule && neat.generation % options.schedule.iterations === 0) {\r\n                            options.schedule.function(fitness, -error, neat.generation);\r\n                        }\r\n                        return [3 /*break*/, 1];\r\n                    case 3:\r\n                        if (bestGenome !== undefined) {\r\n                            this.nodes = bestGenome.nodes;\r\n                            this.connections = bestGenome.connections;\r\n                            this.gates = bestGenome.gates;\r\n                            if (options.clear) {\r\n                                this.clear();\r\n                            }\r\n                        }\r\n                        return [2 /*return*/, {\r\n                                error: -error,\r\n                                iterations: neat.generation,\r\n                                time: Date.now() - start,\r\n                            }];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return Network;\r\n}());\r\nexports.Network = Network;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Activation_1 = require(\"../methods/Activation\");\r\nvar Connection_1 = require(\"./Connection\");\r\nvar Utils_1 = require(\"../methods/Utils\");\r\nvar NodeType;\r\n(function (NodeType) {\r\n    NodeType[NodeType[\"INPUT\"] = 0] = \"INPUT\";\r\n    NodeType[NodeType[\"HIDDEN\"] = 1] = \"HIDDEN\";\r\n    NodeType[NodeType[\"OUTPUT\"] = 2] = \"OUTPUT\";\r\n})(NodeType = exports.NodeType || (exports.NodeType = {}));\r\nvar Node = /** @class */ (function () {\r\n    function Node(type) {\r\n        if (type === void 0) { type = NodeType.HIDDEN; }\r\n        this.type = type;\r\n        this.bias = Utils_1.randDouble(-1, 1);\r\n        this.squash = new Activation_1.LogisticActivation();\r\n        this.activation = 0;\r\n        this.state = 0;\r\n        this.old = 0;\r\n        this.mask = 1;\r\n        this.deltaBiasPrevious = 0;\r\n        this.deltaBiasTotal = 0;\r\n        this.incoming = [];\r\n        this.outgoing = [];\r\n        this.gated = [];\r\n        this.selfConnection = new Connection_1.Connection(this, this, 0);\r\n        this.errorResponsibility = 0;\r\n        this.errorProjected = 0;\r\n        this.errorGated = 0;\r\n        this.index = NaN;\r\n    }\r\n    Node.fromJSON = function (json) {\r\n        var node = new Node();\r\n        node.bias = json.bias;\r\n        node.type = json.type;\r\n        node.squash = Activation_1.Activation.getActivation(json.squash);\r\n        node.mask = json.mask;\r\n        node.index = json.index;\r\n        return node;\r\n    };\r\n    Node.prototype.clear = function () {\r\n        for (var _i = 0, _a = this.incoming; _i < _a.length; _i++) {\r\n            var connection = _a[_i];\r\n            connection.eligibility = 0;\r\n            connection.xTraceNodes = [];\r\n            connection.xTraceValues = [];\r\n        }\r\n        for (var _b = 0, _c = this.gated; _b < _c.length; _b++) {\r\n            var connection = _c[_b];\r\n            connection.gain = 0;\r\n        }\r\n        this.errorResponsibility = this.errorProjected = this.errorGated = 0;\r\n        this.old = this.state = this.activation = 0;\r\n    };\r\n    Node.prototype.mutateBias = function (method) {\r\n        this.bias += Utils_1.randDouble(method.min, method.max);\r\n    };\r\n    Node.prototype.mutateActivation = function () {\r\n        var newActivationType;\r\n        do {\r\n            newActivationType = Utils_1.pickRandom(Activation_1.ALL_ACTIVATIONS);\r\n        } while (newActivationType === this.squash.type);\r\n        this.squash = Activation_1.Activation.getActivation(newActivationType);\r\n    };\r\n    Node.prototype.isProjectedBy = function (node) {\r\n        if (node === this) {\r\n            return this.selfConnection.weight !== 0;\r\n        }\r\n        else {\r\n            return Utils_1.anyMatch(this.incoming.map(function (conn) { return conn.from; }), node);\r\n        }\r\n    };\r\n    Node.prototype.isProjectingTo = function (node) {\r\n        if (node === this) {\r\n            return this.selfConnection.weight !== 0;\r\n        }\r\n        else {\r\n            return Utils_1.anyMatch(this.outgoing.map(function (conn) { return conn.to; }), node);\r\n        }\r\n    };\r\n    Node.prototype.addGate = function (connection) {\r\n        this.gated.push(connection);\r\n        connection.gateNode = this;\r\n    };\r\n    Node.prototype.removeGate = function (connection) {\r\n        Utils_1.remove(this.gated, connection);\r\n        connection.gateNode = null;\r\n        connection.gain = 1;\r\n    };\r\n    Node.prototype.connect = function (target, weight, twoSided) {\r\n        if (weight === void 0) { weight = 0; }\r\n        if (twoSided === void 0) { twoSided = false; }\r\n        if (target === this) {\r\n            this.selfConnection.weight = weight || 1;\r\n            return this.selfConnection;\r\n        }\r\n        else if (this.isProjectingTo(target)) {\r\n            throw new ReferenceError();\r\n        }\r\n        else {\r\n            var connection = new Connection_1.Connection(this, target, weight);\r\n            this.outgoing.push(connection);\r\n            target.incoming.push(connection);\r\n            if (twoSided) {\r\n                target.connect(this);\r\n            }\r\n            return connection;\r\n        }\r\n    };\r\n    Node.prototype.disconnect = function (node, twoSided) {\r\n        if (twoSided === void 0) { twoSided = false; }\r\n        if (node === this) {\r\n            this.selfConnection.weight = 0;\r\n            return this.selfConnection;\r\n        }\r\n        for (var _i = 0, _a = this.outgoing; _i < _a.length; _i++) {\r\n            var connection = _a[_i];\r\n            if (connection.to !== node) {\r\n                continue;\r\n            }\r\n            Utils_1.remove(this.outgoing, connection);\r\n            Utils_1.remove(connection.to.incoming, connection);\r\n            if (connection.gateNode !== undefined && connection.gateNode != null) {\r\n                connection.gateNode.removeGate(connection);\r\n            }\r\n            if (twoSided) {\r\n                node.disconnect(this);\r\n            }\r\n            return connection;\r\n        }\r\n        throw new Error(\"No connection found!\");\r\n    };\r\n    Node.prototype.propagate = function (target, momentum, rate, update) {\r\n        // TODO: check for errors\r\n        if (target !== undefined && Number.isFinite(target)) {\r\n            this.errorResponsibility = this.errorProjected = target - this.activation;\r\n        }\r\n        else {\r\n            this.errorProjected = 0;\r\n            for (var _i = 0, _a = this.outgoing; _i < _a.length; _i++) {\r\n                var connection = _a[_i];\r\n                this.errorProjected += connection.to.errorResponsibility * connection.weight * connection.gain;\r\n            }\r\n            this.errorProjected *= this.derivative || 1;\r\n            this.errorGated = 0;\r\n            for (var _b = 0, _c = this.gated; _b < _c.length; _b++) {\r\n                var connection = _c[_b];\r\n                var node = connection.to;\r\n                var influence = void 0;\r\n                if (node.selfConnection.gateNode === this) {\r\n                    influence = node.old + connection.weight * connection.from.activation;\r\n                }\r\n                else {\r\n                    influence = connection.weight * connection.from.activation;\r\n                }\r\n                this.errorGated += node.errorResponsibility * influence;\r\n            }\r\n            this.errorGated *= this.derivative || 1;\r\n            this.errorResponsibility = this.errorProjected + this.errorGated;\r\n        }\r\n        for (var _d = 0, _e = this.incoming; _d < _e.length; _d++) {\r\n            var connection = _e[_d];\r\n            var gradient = this.errorProjected * connection.eligibility;\r\n            for (var j = 0; j < connection.xTraceNodes.length; j++) {\r\n                var node = connection.xTraceNodes[j];\r\n                gradient += node.errorResponsibility * connection.xTraceValues[j];\r\n            }\r\n            connection.deltaWeightsTotal += rate * gradient * this.mask;\r\n            if (update) {\r\n                connection.deltaWeightsTotal += momentum * connection.deltaWeightsPrevious;\r\n                connection.weight += connection.deltaWeightsTotal;\r\n                connection.deltaWeightsPrevious = connection.deltaWeightsTotal;\r\n                connection.deltaWeightsTotal = 0;\r\n            }\r\n        }\r\n        this.deltaBiasTotal += rate * this.errorResponsibility;\r\n        if (update) {\r\n            this.deltaBiasTotal += momentum * this.deltaBiasPrevious;\r\n            this.bias += this.deltaBiasTotal;\r\n            this.deltaBiasPrevious = this.deltaBiasTotal;\r\n            this.deltaBiasTotal = 0;\r\n        }\r\n        return {\r\n            responsibility: this.errorResponsibility,\r\n            projected: this.errorProjected,\r\n            gated: this.errorGated,\r\n        };\r\n    };\r\n    Node.prototype.activate = function (input, trace) {\r\n        var _this = this;\r\n        if (input === void 0) { input = null; }\r\n        if (trace === void 0) { trace = true; }\r\n        // TODO: check for errors\r\n        if (input !== null && Number.isFinite(input)) {\r\n            return this.activation = input;\r\n        }\r\n        if (trace) {\r\n            this.old = this.state;\r\n            this.state = this.selfConnection.gain * this.selfConnection.weight * this.state + this.bias;\r\n            this.incoming.forEach(function (conn) {\r\n                _this.state += conn.from.activation * conn.weight * conn.gain;\r\n            });\r\n            this.activation = this.squash.calc(this.state, false) * this.mask;\r\n            this.derivative = this.squash.calc(this.state, true);\r\n            var nodes_1 = [];\r\n            var influences_1 = [];\r\n            this.gated.forEach(function (connection) {\r\n                connection.gain = _this.activation;\r\n                var index = nodes_1.indexOf(connection.to);\r\n                if (index > -1) {\r\n                    influences_1[index] += connection.weight * connection.from.activation;\r\n                }\r\n                else {\r\n                    nodes_1.push(connection.to);\r\n                    if (connection.to.selfConnection.gateNode === _this) {\r\n                        influences_1.push(connection.weight * connection.from.activation + connection.to.old);\r\n                    }\r\n                    else {\r\n                        influences_1.push(connection.weight * connection.from.activation);\r\n                    }\r\n                }\r\n            });\r\n            for (var _i = 0, _a = this.incoming; _i < _a.length; _i++) {\r\n                var connection = _a[_i];\r\n                connection.eligibility = this.selfConnection.gain * this.selfConnection.weight * connection.eligibility + connection.from.activation * connection.gain;\r\n                for (var i = 0; i < nodes_1.length; i++) {\r\n                    var node = nodes_1[i];\r\n                    var influence = influences_1[i];\r\n                    var index = connection.xTraceNodes.indexOf(node);\r\n                    if (index > -1)\r\n                        connection.xTraceValues[index] = node.selfConnection.gain * node.selfConnection.weight * connection.xTraceValues[index] + this.derivative * connection.eligibility * influence;\r\n                    else {\r\n                        connection.xTraceNodes.push(node);\r\n                        connection.xTraceValues.push(this.derivative * connection.eligibility * influence);\r\n                    }\r\n                }\r\n            }\r\n            return this.activation;\r\n        }\r\n        else {\r\n            if (this.type === NodeType.INPUT)\r\n                return this.activation = 0;\r\n            this.state = this.selfConnection.gain * this.selfConnection.weight * this.state + this.bias;\r\n            for (var _b = 0, _c = this.incoming; _b < _c.length; _b++) {\r\n                var connection = _c[_b];\r\n                this.state += connection.from.activation * connection.weight * connection.gain;\r\n            }\r\n            this.activation = this.squash.calc(this.state, false);\r\n            for (var _d = 0, _e = this.gated; _d < _e.length; _d++) {\r\n                var connection = _e[_d];\r\n                connection.gain = this.activation;\r\n            }\r\n            return this.activation;\r\n        }\r\n    };\r\n    Node.prototype.toJSON = function () {\r\n        return {\r\n            bias: this.bias,\r\n            type: this.type,\r\n            squash: this.squash.type,\r\n            mask: this.mask,\r\n            index: this.index\r\n        };\r\n    };\r\n    return Node;\r\n}());\r\nexports.Node = Node;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Layer_1 = require(\"./architecture/layer/Layer\");\r\nexports.Layer = Layer_1.Layer;\r\nvar ConvolutionLayer_1 = require(\"./architecture/layer/ConvolutionLayer\");\r\nexports.ConvolutionLayer = ConvolutionLayer_1.ConvolutionLayer;\r\nvar DenseLayer_1 = require(\"./architecture/layer/DenseLayer\");\r\nexports.DenseLayer = DenseLayer_1.DenseLayer;\r\nvar GaussianNoiseLayer_1 = require(\"./architecture/layer/GaussianNoiseLayer\");\r\nexports.GaussianNoiseLayer = GaussianNoiseLayer_1.GaussianNoiseLayer;\r\nvar InputLayer_1 = require(\"./architecture/layer/InputLayer\");\r\nexports.InputLayer = InputLayer_1.InputLayer;\r\nvar LSTMLayer_1 = require(\"./architecture/layer/LSTMLayer\");\r\nexports.LSTMLayer = LSTMLayer_1.LSTMLayer;\r\nvar PoolLayer_1 = require(\"./architecture/layer/PoolLayer\");\r\nexports.PoolLayer = PoolLayer_1.PoolLayer;\r\nvar RNNLayer_1 = require(\"./architecture/layer/RNNLayer\");\r\nexports.RNNLayer = RNNLayer_1.RNNLayer;\r\nvar Architect_1 = require(\"./architecture/Architect\");\r\nexports.Architect = Architect_1.Architect;\r\nvar Connection_1 = require(\"./architecture/Connection\");\r\nexports.Connection = Connection_1.Connection;\r\nvar Network_1 = require(\"./architecture/Network\");\r\nexports.Network = Network_1.Network;\r\nvar node_1 = require(\"./architecture/node\");\r\nexports.Node = node_1.Node;\r\nvar Activation_1 = require(\"./methods/Activation\");\r\nexports.Activation = Activation_1.Activation;\r\nvar Loss_1 = require(\"./methods/Loss\");\r\nexports.Loss = Loss_1.Loss;\r\nvar Mutation_1 = require(\"./methods/Mutation\");\r\nexports.Mutation = Mutation_1.Mutation;\r\nvar Rate_1 = require(\"./methods/Rate\");\r\nexports.Rate = Rate_1.Rate;\r\nvar Selection_1 = require(\"./methods/Selection\");\r\nexports.Selection = Selection_1.Selection;\r\nvar NEAT_1 = require(\"./NEAT\");\r\nexports.NEAT = NEAT_1.NEAT;\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}